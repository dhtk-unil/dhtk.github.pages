
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.11">
    
    
      
        <title>DHTK - The Digital Humanities ToolKit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dhtk.core.system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Digital Humanities ToolKit" class="md-header__button md-logo" aria-label="The Digital Humanities ToolKit" data-md-component="logo">
      
  <img src="../../img/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Digital Humanities ToolKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DHTK
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Digital Humanities ToolKit" class="md-nav__button md-logo" aria-label="The Digital Humanities ToolKit" data-md-component="logo">
      
  <img src="../../img/favicon.ico" alt="logo">

    </a>
    The Digital Humanities ToolKit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/" class="md-nav__link">
        User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dev_guide/" class="md-nav__link">
        Developer Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          DHTK
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        DHTK
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dhtk.core.system" class="md-nav__link">
    system
  </a>
  
    <nav class="md-nav" aria-label="system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.download_files" class="md-nav__link">
    download_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.get_date" class="md-nav__link">
    get_date()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.get_platform" class="md-nav__link">
    get_platform()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.make_dirs" class="md-nav__link">
    make_dirs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.pip_install" class="md-nav__link">
    pip_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.url_exists" class="md-nav__link">
    url_exists()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg" class="md-nav__link">
    gutenberg
  </a>
  
    <nav class="md-nav" aria-label="gutenberg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module" class="md-nav__link">
    Module
  </a>
  
    <nav class="md-nav" aria-label="Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get" class="md-nav__link">
    get()
  </a>
  
    <nav class="md-nav" aria-label="get()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get_data_file" class="md-nav__link">
    get_data_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api" class="md-nav__link">
    api
  </a>
  
    <nav class="md-nav" aria-label="api">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus" class="md-nav__link">
    corpus
  </a>
  
    <nav class="md-nav" aria-label="corpus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus" class="md-nav__link">
    GutenbergCorpus
  </a>
  
    <nav class="md-nav" aria-label="GutenbergCorpus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__iter__" class="md-nav__link">
    __iter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_book" class="md-nav__link">
    add_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_books" class="md-nav__link">
    add_books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.books" class="md-nav__link">
    books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.clear" class="md-nav__link">
    clear()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.description" class="md-nav__link">
    description()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_book" class="md-nav__link">
    download_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_corpus" class="md-nav__link">
    download_corpus()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_metadata" class="md-nav__link">
    download_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.get_book_file_name" class="md-nav__link">
    get_book_file_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.name" class="md-nav__link">
    name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.path" class="md-nav__link">
    path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.remove_book" class="md-nav__link">
    remove_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_pandas_dataframe" class="md-nav__link">
    to_pandas_dataframe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData" class="md-nav__link">
    GutenbergData
  </a>
  
    <nav class="md-nav" aria-label="GutenbergData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_authors" class="md-nav__link">
    all_authors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_books" class="md-nav__link">
    all_books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_bookshelves" class="md-nav__link">
    all_bookshelves()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_subjects" class="md-nav__link">
    all_subjects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.bookshelves_subjects" class="md-nav__link">
    bookshelves_subjects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_author" class="md-nav__link">
    get_author()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_bibliography" class="md-nav__link">
    get_bibliography()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_book" class="md-nav__link">
    get_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_metadata" class="md-nav__link">
    get_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_author" class="md-nav__link">
    search_by_author()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_bookshelf" class="md-nav__link">
    search_by_bookshelf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_subject" class="md-nav__link">
    search_by_subject()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_title" class="md-nav__link">
    search_by_title()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.statistics" class="md-nav__link">
    statistics()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder" class="md-nav__link">
    builder
  </a>
  
    <nav class="md-nav" aria-label="builder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.get_metadata" class="md-nav__link">
    get_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.owl_test" class="md-nav__link">
    owl_test()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.serialize" class="md-nav__link">
    serialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.unpack_archive" class="md-nav__link">
    unpack_archive()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools" class="md-nav__link">
    tools
  </a>
  
    <nav class="md-nav" aria-label="tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author" class="md-nav__link">
    author
  </a>
  
    <nav class="md-nav" aria-label="author">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor" class="md-nav__link">
    GutenbergAuthor
  </a>
  
    <nav class="md-nav" aria-label="GutenbergAuthor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.convert_name" class="md-nav__link">
    convert_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.get_gutenberg_id" class="md-nav__link">
    get_gutenberg_id()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book" class="md-nav__link">
    book
  </a>
  
    <nav class="md-nav" aria-label="book">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book--contains-the-gutenbergbook-class" class="md-nav__link">
    Contains the GutenbergBook Class.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook" class="md-nav__link">
    GutenbergBook
  </a>
  
    <nav class="md-nav" aria-label="GutenbergBook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id" class="md-nav__link">
    get_book_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id_number" class="md-nav__link">
    get_book_id_number()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path" class="md-nav__link">
    get_text_file_dir_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_uri" class="md-nav__link">
    get_uri()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts" class="md-nav__link">
    texts
  </a>
  
    <nav class="md-nav" aria-label="texts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts" class="md-nav__link">
    GutenbergTexts
  </a>
  
    <nav class="md-nav" aria-label="GutenbergTexts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.close" class="md-nav__link">
    close()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.get_original_text" class="md-nav__link">
    get_original_text()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.save_original_text_file_to" class="md-nav__link">
    save_original_text_file_to()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.unarchive_book" class="md-nav__link">
    unarchive_book()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dhtk.core.system" class="md-nav__link">
    system
  </a>
  
    <nav class="md-nav" aria-label="system">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.download_files" class="md-nav__link">
    download_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.get_date" class="md-nav__link">
    get_date()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.get_platform" class="md-nav__link">
    get_platform()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.make_dirs" class="md-nav__link">
    make_dirs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.pip_install" class="md-nav__link">
    pip_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.core.system.url_exists" class="md-nav__link">
    url_exists()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg" class="md-nav__link">
    gutenberg
  </a>
  
    <nav class="md-nav" aria-label="gutenberg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module" class="md-nav__link">
    Module
  </a>
  
    <nav class="md-nav" aria-label="Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get" class="md-nav__link">
    get()
  </a>
  
    <nav class="md-nav" aria-label="get()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.Module.get_data_file" class="md-nav__link">
    get_data_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api" class="md-nav__link">
    api
  </a>
  
    <nav class="md-nav" aria-label="api">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus" class="md-nav__link">
    corpus
  </a>
  
    <nav class="md-nav" aria-label="corpus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus" class="md-nav__link">
    GutenbergCorpus
  </a>
  
    <nav class="md-nav" aria-label="GutenbergCorpus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__iter__" class="md-nav__link">
    __iter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_book" class="md-nav__link">
    add_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_books" class="md-nav__link">
    add_books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.books" class="md-nav__link">
    books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.clear" class="md-nav__link">
    clear()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.description" class="md-nav__link">
    description()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_book" class="md-nav__link">
    download_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_corpus" class="md-nav__link">
    download_corpus()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_metadata" class="md-nav__link">
    download_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.get_book_file_name" class="md-nav__link">
    get_book_file_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.name" class="md-nav__link">
    name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.path" class="md-nav__link">
    path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.remove_book" class="md-nav__link">
    remove_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_pandas_dataframe" class="md-nav__link">
    to_pandas_dataframe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData" class="md-nav__link">
    GutenbergData
  </a>
  
    <nav class="md-nav" aria-label="GutenbergData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_authors" class="md-nav__link">
    all_authors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_books" class="md-nav__link">
    all_books()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_bookshelves" class="md-nav__link">
    all_bookshelves()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.all_subjects" class="md-nav__link">
    all_subjects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.bookshelves_subjects" class="md-nav__link">
    bookshelves_subjects()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_author" class="md-nav__link">
    get_author()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_bibliography" class="md-nav__link">
    get_bibliography()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_book" class="md-nav__link">
    get_book()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.get_metadata" class="md-nav__link">
    get_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_author" class="md-nav__link">
    search_by_author()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_bookshelf" class="md-nav__link">
    search_by_bookshelf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_subject" class="md-nav__link">
    search_by_subject()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_title" class="md-nav__link">
    search_by_title()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.api.data.GutenbergData.statistics" class="md-nav__link">
    statistics()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder" class="md-nav__link">
    builder
  </a>
  
    <nav class="md-nav" aria-label="builder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.get_metadata" class="md-nav__link">
    get_metadata()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.owl_test" class="md-nav__link">
    owl_test()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.serialize" class="md-nav__link">
    serialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.data.builder.unpack_archive" class="md-nav__link">
    unpack_archive()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools" class="md-nav__link">
    tools
  </a>
  
    <nav class="md-nav" aria-label="tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author" class="md-nav__link">
    author
  </a>
  
    <nav class="md-nav" aria-label="author">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor" class="md-nav__link">
    GutenbergAuthor
  </a>
  
    <nav class="md-nav" aria-label="GutenbergAuthor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.convert_name" class="md-nav__link">
    convert_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.get_gutenberg_id" class="md-nav__link">
    get_gutenberg_id()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book" class="md-nav__link">
    book
  </a>
  
    <nav class="md-nav" aria-label="book">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book--contains-the-gutenbergbook-class" class="md-nav__link">
    Contains the GutenbergBook Class.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook" class="md-nav__link">
    GutenbergBook
  </a>
  
    <nav class="md-nav" aria-label="GutenbergBook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id" class="md-nav__link">
    get_book_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id_number" class="md-nav__link">
    get_book_id_number()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path" class="md-nav__link">
    get_text_file_dir_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_uri" class="md-nav__link">
    get_uri()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts" class="md-nav__link">
    texts
  </a>
  
    <nav class="md-nav" aria-label="texts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts" class="md-nav__link">
    GutenbergTexts
  </a>
  
    <nav class="md-nav" aria-label="GutenbergTexts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.close" class="md-nav__link">
    close()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.get_original_text" class="md-nav__link">
    get_original_text()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.save_original_text_file_to" class="md-nav__link">
    save_original_text_file_to()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhtk.data_sources.gutenberg.tools.texts.unarchive_book" class="md-nav__link">
    unarchive_book()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>DHTK</h1>

<div class="doc doc-object doc-module">



<h2 id="dhtk.core.system" class="doc doc-heading">
        <code>dhtk.core.system</code>



</h2>

    <div class="doc doc-contents first">

      <p>Utility functions used by all modules.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.download_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_files</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">file_names</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to download files from the Web.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urls</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>URLs of the files to be downloaded</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>Path to directory to store the downloaded files. (Default value = "./")</p></td>
        <td><code>&#39;./&#39;</code></td>
      </tr>
      <tr>
        <td><code>file_names</code></td>
        <td><code>Union[str, List[str]</code></td>
        <td><p>Output name or names of the files to be downloaded.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_files</span><span class="p">(</span>
        <span class="n">urls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span>
        <span class="n">file_names</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Function to download files from the Web.</span>

<span class="sd">    Args:</span>
<span class="sd">      urls (typing.Union[str, typing.List[str]]): URLs of the files to be downloaded</span>
<span class="sd">      path (str, optional): Path to directory to store the downloaded files. (Default value = &quot;./&quot;)</span>
<span class="sd">      file_names (typing.Union[str, typing.List[str], optional): Output name or names of the files to be downloaded.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Convert inputs to list</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">urls</span><span class="p">]</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Request all files</span>
    <span class="n">get_file_names</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_names</span><span class="p">:</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">get_file_names</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_names</span><span class="p">,</span> <span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_names</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;The list of filenames should correspond to the list of urls.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>  <span class="c1"># Check if URL is valid</span>
            <span class="k">if</span> <span class="n">get_file_names</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span> <span class="o">/</span> <span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_names</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">file_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">file_paths</span>
            <span class="c1"># Make request</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">get_platform</span><span class="p">()}</span>
            <span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
                <span class="n">request</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="mi">8192</span>
                <span class="n">total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Length&#39;</span><span class="p">])</span>

                <span class="c1"># Read to file</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_file</span><span class="p">:</span>
                    <span class="k">with</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">progress_bar</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk</span><span class="p">):</span>
                            <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                            <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;DOWNLOAD: </span><span class="si">%s</span><span class="s2"> downloaded from  </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Warn if URL is not valid</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;URL not available: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;DOWNLOAD: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Return a string if there is only one file</span>
        <span class="n">file_names</span> <span class="o">=</span> <span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">file_names</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.get_date" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_date</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to get last modified date of a remote file</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>the url link</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>datetime (datetime)</code></td>
      <td><p>the datatime object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_date</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to get last modified date of a remote file</span>

<span class="sd">    Args:</span>
<span class="sd">      url (str): the url link</span>

<span class="sd">    Returns:</span>
<span class="sd">      datetime (datetime): the datatime object</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">get_platform</span><span class="p">()}</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;last-modified&#39;</span><span class="p">]</span>
    <span class="n">last_update</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> %b %Y %H:%M:%S %Z&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">last_update</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.get_platform" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_platform</span><span class="p">()</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns computes platform.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_platform</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Returns computes platform.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&quot;(</span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="si">}</span><span class="s1">; U; </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">; en-us)&quot;&#39;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.make_dirs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_dirs</span><span class="p">(</span><span class="n">directories</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to create new directories at DHTK's initiation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>directories</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>the new directory path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_dirs</span><span class="p">(</span><span class="n">directories</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to create new directories at DHTK&#39;s initiation.</span>

<span class="sd">    Args:</span>
<span class="sd">      directories (typing.Union[str, typing.List[str]]): the new directory path</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert values to list</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">directories</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">directories</span> <span class="o">=</span> <span class="p">[</span><span class="n">directories</span><span class="p">]</span>

    <span class="c1"># For each directory, confirm value is a pathlib.Path object and directory doesn&#39;t exist</span>
    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not create </span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">, please check user rights.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.pip_install" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pip_install</span><span class="p">(</span><span class="n">module_type</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Helper function to install missing modules</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>module_type</code></td>
        <td><code>str</code></td>
        <td><p>possible values "data_sources"  or "storage"</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>module</code></td>
        <td></td>
        <td><p>"the dhtk module name"</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>the imported module.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pip_install</span><span class="p">(</span><span class="n">module_type</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to install missing modules</span>

<span class="sd">    Args:</span>
<span class="sd">        module_type (str): possible values &quot;data_sources&quot;  or &quot;storage&quot;</span>
<span class="sd">        module: &quot;the dhtk module name&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        the imported module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;dummy&#39;</span> <span class="ow">in</span> <span class="n">module</span><span class="p">:</span>
        <span class="n">module_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dhtk_</span><span class="si">{</span><span class="n">module_type</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">module_import</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dhtk.</span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">git_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;git+ssh://git@gitlab.com/dhtk/dhtk_</span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2">/examples/</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">module_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dhtk_</span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">module_import</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dhtk.</span><span class="si">{</span><span class="n">module_type</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">git_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;git+ssh://git@gitlab.com/dhtk/dhtk_</span><span class="si">{</span><span class="n">module_type</span><span class="si">}</span><span class="s2">s/</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_INTERACTIVE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This method is for interactive usage only! Please install </span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2"> manually:&quot;</span>
                               <span class="sa">f</span><span class="s2">&quot;$ pip install </span><span class="si">{</span><span class="n">git_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Do you want dhtk to install </span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">? [y/N]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">answer</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please install the module manually: $ pip install </span><span class="si">{</span><span class="n">git_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;pip&#39;</span><span class="p">,</span> <span class="s1">&#39;install&#39;</span><span class="p">,</span> <span class="n">git_url</span><span class="p">]</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">]</span> <span class="o">+</span> <span class="n">cmd</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2"> not available.&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;DATASET: &quot;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span>
        <span class="n">module_import</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="dhtk.core.system.url_exists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to check if an url is available.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>the path to check</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/core/system.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to check if an url is available.</span>

<span class="sd">    Args:</span>
<span class="sd">      url (str): the path to check</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If the URL is a local file</span>
    <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;file:&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># If URL is a remote file</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="dhtk.data_sources.gutenberg" class="doc doc-heading">
        <code>dhtk.data_sources.gutenberg</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents first">

      <p>Gutenberg extension data_source</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h3 id="dhtk.data_sources.gutenberg.Module" class="doc doc-heading">
        <code>
Module            (<span title="dhtk.data_sources.blueprint.AbstractDataSource">AbstractDataSource</span>)
        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Gutenberg Triplestore Class</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Module</span><span class="p">(</span><span class="n">AbstractDataSource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gutenberg Triplestore Class&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;gutenberg&quot;</span>
    <span class="n">storage_type</span> <span class="o">=</span> <span class="s2">&quot;triplestore&quot;</span>
    <span class="n">data_file</span> <span class="o">=</span> <span class="s2">&quot;https://sandbox.zenodo.org/record/967894/files/gutenberg-dhtk-reasoned.ttl?download=1&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_data_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">storage_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a content as defined in self.data_file and write into a file into output_path</span>
<span class="sd">        Args:</span>
<span class="sd">            output_path (Path): the path where to write (i.e. output_path = Path(&#39;WD/gutenberg/data/triplestore&#39;))</span>
<span class="sd">            storage_type (str): the type of the storage</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: the path to the file with data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#output_path can be like this output_path = &#39;WD/gutenberg/data/triplestore&#39;</span>
        <span class="c1">#storage_type can be like this storage_type= &#39;triplestore&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data_file</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">data_file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_file</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">storage_type</span><span class="p">)]</span>
        <span class="n">download_files</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;gutenberg.ttl&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_path</span> <span class="o">/</span> <span class="s2">&quot;gutenberg.ttl&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">working_directory</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">):</span>

        <span class="c1"># Get the extension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">GutenbergData</span><span class="p">(</span><span class="n">sparql_endpoint</span><span class="o">=</span><span class="n">endpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Instantiate a Corpus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span> <span class="o">=</span> <span class="n">GutenbergCorpus</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Corpus&quot;</span><span class="p">,</span>
            <span class="n">working_directory</span><span class="o">=</span><span class="n">working_directory</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Gutenberg Books&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">welcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">statistics</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">RemoteDisconnected</span><span class="p">,</span> <span class="n">URLError</span><span class="p">,</span> <span class="ne">ConnectionResetError</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">check</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;WARNING: There is a problem with the connection!&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probably Docker is slow to restart!&quot;</span><span class="p">)</span>
                    <span class="n">stats</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No statistics available&quot;</span>
                    <span class="k">break</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extension wrapper method to call all DHTK functionalities with a simple syntax</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        what: string</span>
<span class="sd">            Type of information to retrieve.</span>
<span class="sd">            DHTK Gutenberg has the options to search for books, authors, shelves and subjects</span>
<span class="sd">        name: string [default: &quot;all&quot;]</span>
<span class="sd">            Name identifying the specific information to retrieve.</span>
<span class="sd">            If all, retrieve all information available</span>
<span class="sd">        add: boolean [default: False]</span>
<span class="sd">            Add query results to Corpus</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Requested book information from Gutenberg dataset</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Prepare arguments</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">what</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bo&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_books</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

                <span class="c1"># Use a short book title</span>
                <span class="n">response</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">:</span> <span class="n">book</span>
                            <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">}</span>

        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;au&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_authors</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_author</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="s2">&quot;author_id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">)</span>
                <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_author</span><span class="p">(</span><span class="n">author</span><span class="p">)</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">author</span><span class="o">.</span><span class="n">get_bibliography</span><span class="p">():</span>
                            <span class="n">books</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="s2">&quot;book&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">book</span><span class="p">)</span>

                            <span class="n">books</span> <span class="o">=</span> <span class="p">{</span><span class="n">title</span><span class="p">:</span> <span class="n">book</span> <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> \
                                     <span class="k">if</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span> <span class="o">==</span> <span class="n">author</span><span class="p">}</span>

                            <span class="c1"># Match short book key name</span>
                            <span class="n">sub_title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">book</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
                            <span class="n">books</span> <span class="o">=</span> <span class="p">[</span><span class="n">book</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">sub_title</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">books</span><span class="p">)</span>

                <span class="n">response</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">author</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">}</span>

        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_bookshelves</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_bookshelf</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                    <span class="n">add</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>

                <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">shelf</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                    <span class="n">book</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">],</span> <span class="p">[])</span>

                    <span class="k">if</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]:</span>
                        <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">book</span><span class="p">]</span>

                <span class="n">response</span> <span class="o">=</span> <span class="n">results</span>

        <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;su&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_subjects</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_subject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                    <span class="n">add</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>

                <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                    <span class="n">book</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span> <span class="p">[])</span>

                    <span class="k">if</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]:</span>
                        <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">book</span><span class="p">]</span>

                <span class="n">response</span> <span class="o">=</span> <span class="n">results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not a valid option&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Allowed arguments are:</span><span class="se">\n</span><span class="s2">book</span><span class="se">\n</span><span class="s2">author</span><span class="se">\n</span><span class="s2">shelf</span><span class="se">\n</span><span class="s2">subject&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No </span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2"> found.</span><span class="se">\n</span><span class="s2">&quot;</span>
                          <span class="s2">&quot;Please make sure there are no spelling mistakes.</span><span class="se">\n</span><span class="s2">&quot;</span>
                          <span class="s2">&quot;You may search all available options by ignoring the [name] argument&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">corpus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">description</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="c1"># Prepare save directory</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">path</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">make_dirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Save Gutenberg Texts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">download_corpus</span><span class="p">()</span>

        <span class="c1"># Save metadata table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">download_metadata</span><span class="p">()</span>

        <span class="c1"># Save Python Query Object</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;corpus.pk&quot;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickled_file</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">to_pandas_dataframe</span><span class="p">(),</span>
                        <span class="n">pickled_file</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
        <span class="n">pickled_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">close</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h4 id="dhtk.data_sources.gutenberg.Module.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Extension wrapper method to call all DHTK functionalities with a simple syntax</p>
<h6 id="dhtk.data_sources.gutenberg.Module.get--parameters">Parameters</h6>
<p>!!! what "string"
    Type of information to retrieve.
    DHTK Gutenberg has the options to search for books, authors, shelves and subjects
!!! name "string [default: "all"]"
    Name identifying the specific information to retrieve.
    If all, retrieve all information available
!!! add "boolean [default: False]"
    Add query results to Corpus</p>
<h6 id="dhtk.data_sources.gutenberg.Module.get--returns">Returns</h6>
<p>Requested book information from Gutenberg dataset</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension wrapper method to call all DHTK functionalities with a simple syntax</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    what: string</span>
<span class="sd">        Type of information to retrieve.</span>
<span class="sd">        DHTK Gutenberg has the options to search for books, authors, shelves and subjects</span>
<span class="sd">    name: string [default: &quot;all&quot;]</span>
<span class="sd">        Name identifying the specific information to retrieve.</span>
<span class="sd">        If all, retrieve all information available</span>
<span class="sd">    add: boolean [default: False]</span>
<span class="sd">        Add query results to Corpus</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Requested book information from Gutenberg dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Prepare arguments</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">what</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;bo&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_books</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

            <span class="c1"># Use a short book title</span>
            <span class="n">response</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">:</span> <span class="n">book</span>
                        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">}</span>

    <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;au&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_authors</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_author</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="s2">&quot;author_id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_author</span><span class="p">(</span><span class="n">author</span><span class="p">)</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">author</span><span class="o">.</span><span class="n">get_bibliography</span><span class="p">():</span>
                        <span class="n">books</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="s2">&quot;book&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">book</span><span class="p">)</span>

                        <span class="n">books</span> <span class="o">=</span> <span class="p">{</span><span class="n">title</span><span class="p">:</span> <span class="n">book</span> <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> \
                                 <span class="k">if</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span> <span class="o">==</span> <span class="n">author</span><span class="p">}</span>

                        <span class="c1"># Match short book key name</span>
                        <span class="n">sub_title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">book</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
                        <span class="n">books</span> <span class="o">=</span> <span class="p">[</span><span class="n">book</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">sub_title</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">books</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">author</span> <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">response</span><span class="p">}</span>

    <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_bookshelves</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_bookshelf</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">shelf</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="n">book</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">],</span> <span class="p">[])</span>

                <span class="k">if</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]:</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">shelf</span><span class="p">[</span><span class="s1">&#39;bookshelf&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">book</span><span class="p">]</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">results</span>

    <span class="k">elif</span> <span class="n">what</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;su&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">all_subjects</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">search_by_subject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
                <span class="n">add</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">get_book</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;book_id&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">response</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="n">book</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span> <span class="p">[])</span>

                <span class="k">if</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]:</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">book</span><span class="p">]</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">results</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not a valid option&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Allowed arguments are:</span><span class="se">\n</span><span class="s2">book</span><span class="se">\n</span><span class="s2">author</span><span class="se">\n</span><span class="s2">shelf</span><span class="se">\n</span><span class="s2">subject&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No </span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2"> found.</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="s2">&quot;Please make sure there are no spelling mistakes.</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="s2">&quot;You may search all available options by ignoring the [name] argument&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="dhtk.data_sources.gutenberg.Module.get_data_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data_file</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">storage_type</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Get a content as defined in self.data_file and write into a file into output_path</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>output_path</code></td>
        <td><code>Path</code></td>
        <td><p>the path where to write (i.e. output_path = Path('WD/gutenberg/data/triplestore'))</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>storage_type</code></td>
        <td><code>str</code></td>
        <td><p>the type of the storage</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Path</code></td>
      <td><p>the path to the file with data</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_data_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">storage_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a content as defined in self.data_file and write into a file into output_path</span>
<span class="sd">    Args:</span>
<span class="sd">        output_path (Path): the path where to write (i.e. output_path = Path(&#39;WD/gutenberg/data/triplestore&#39;))</span>
<span class="sd">        storage_type (str): the type of the storage</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: the path to the file with data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#output_path can be like this output_path = &#39;WD/gutenberg/data/triplestore&#39;</span>
    <span class="c1">#storage_type can be like this storage_type= &#39;triplestore&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">data_file</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">data_file</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_file</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">storage_type</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">storage_type</span><span class="p">)]</span>
    <span class="n">download_files</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;gutenberg.ttl&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output_path</span> <span class="o">/</span> <span class="s2">&quot;gutenberg.ttl&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>







  </div>

    </div>

  </div>






  <div class="doc doc-object doc-module">



<h3 id="dhtk.data_sources.gutenberg.api" class="doc doc-heading">
        <code>api</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.api.corpus" class="doc doc-heading">
        <code>corpus</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus" class="doc doc-heading">
        <code>
GutenbergCorpus            (<span title="dhtk.data_sources.templates.corpus.Corpus">Corpus</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Class to create a corpus from books of type <code>dhtk.common.Book</code>.</p>
<p>!!! notes
    The corpus can be created by a list of books. The list of books can be gotten by applying different filters,like searching a list of books by:</p>
<pre><code>    - subject :class:`Data.search_by_subject()`,
    - author :class:`Data.search_by_author()`,
    - titre :class:`Data.search_by_title()`,
    - bookshelves :class:`Data.search_by_bookshelves()`.

Corpus has a name, description, a path to save and a list of selective books.
A single book or even a list of books can be added to the corpus created.
It is also possible to remove a book or all the books from corpus.
Download a single book or the whole books of the corpus in a local machine
can be also done by this class.
</code></pre>

<p><strong>Examples:</strong></p>
    
      <blockquote>
<blockquote>
<blockquote>
<p>import os
        &gt;&gt;&gt; from pprint import pprint
        &gt;&gt;&gt; from dhtk.data_sources.templates.corpus import Corpus
        &gt;&gt;&gt; from dhtk.data_sources.gutenberg.api.data import GutenbergData
        # Initialise class GutenbergData as gutenberg_search.
        &gt;&gt;&gt; gutenberg_search = GutenbergData()
        # Data the books by bookshelf and store the id of books in the list
        &gt;&gt;&gt; books_found = gutenberg_search.search_by_author("Jane","Austen")
        &gt;&gt;&gt; book_ids = [item['book_id'] for item in books_found]
        &gt;&gt;&gt; books = set()
        # Get only the 4 first books found.
        &gt;&gt;&gt; for book_id in book_ids[0:4]:
            &gt;&gt;&gt; books.add(gutenberg_search.book_from_book_id(book_id))
        # Create the corpus.
        &gt;&gt;&gt; corpus = Corpus(
            &gt;&gt;&gt; "jane_austen",
           &gt;&gt;&gt;  description="Books by Jane Austen",
            &gt;&gt;&gt; corpora_path=os.path.expanduser("~/Desktop/"),
            &gt;&gt;&gt; book_list=books
        &gt;&gt;&gt; )
        &gt;&gt;&gt; corpus.print_book_list()
        # 0 Jane Austen Emma
        # 1 Jane Austen Gevoel en verstand
        # 2 Jane Austen Emma
        # 3 Jane Austen Lady Susan</p>
</blockquote>
</blockquote>
</blockquote>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GutenbergCorpus</span><span class="p">(</span><span class="n">Corpus</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to create a corpus from books of type `dhtk.common.Book`.</span>

<span class="sd">    Notes:</span>
<span class="sd">        The corpus can be created by a list of books. The list of books can be gotten by applying different filters,like searching a list of books by:</span>

<span class="sd">            - subject :class:`Data.search_by_subject()`,</span>
<span class="sd">            - author :class:`Data.search_by_author()`,</span>
<span class="sd">            - titre :class:`Data.search_by_title()`,</span>
<span class="sd">            - bookshelves :class:`Data.search_by_bookshelves()`.</span>

<span class="sd">        Corpus has a name, description, a path to save and a list of selective books.</span>
<span class="sd">        A single book or even a list of books can be added to the corpus created.</span>
<span class="sd">        It is also possible to remove a book or all the books from corpus.</span>
<span class="sd">        Download a single book or the whole books of the corpus in a local machine</span>
<span class="sd">        can be also done by this class.</span>

<span class="sd">    Example:</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &gt;&gt;&gt; import os</span>
<span class="sd">            &gt;&gt;&gt; from pprint import pprint</span>
<span class="sd">            &gt;&gt;&gt; from dhtk.data_sources.templates.corpus import Corpus</span>
<span class="sd">            &gt;&gt;&gt; from dhtk.data_sources.gutenberg.api.data import GutenbergData</span>
<span class="sd">            # Initialise class GutenbergData as gutenberg_search.</span>
<span class="sd">            &gt;&gt;&gt; gutenberg_search = GutenbergData()</span>
<span class="sd">            # Data the books by bookshelf and store the id of books in the list</span>
<span class="sd">            &gt;&gt;&gt; books_found = gutenberg_search.search_by_author(&quot;Jane&quot;,&quot;Austen&quot;)</span>
<span class="sd">            &gt;&gt;&gt; book_ids = [item[&#39;book_id&#39;] for item in books_found]</span>
<span class="sd">            &gt;&gt;&gt; books = set()</span>
<span class="sd">            # Get only the 4 first books found.</span>
<span class="sd">            &gt;&gt;&gt; for book_id in book_ids[0:4]:</span>
<span class="sd">                &gt;&gt;&gt; books.add(gutenberg_search.book_from_book_id(book_id))</span>
<span class="sd">            # Create the corpus.</span>
<span class="sd">            &gt;&gt;&gt; corpus = Corpus(</span>
<span class="sd">                &gt;&gt;&gt; &quot;jane_austen&quot;,</span>
<span class="sd">               &gt;&gt;&gt;  description=&quot;Books by Jane Austen&quot;,</span>
<span class="sd">                &gt;&gt;&gt; corpora_path=os.path.expanduser(&quot;~/Desktop/&quot;),</span>
<span class="sd">                &gt;&gt;&gt; book_list=books</span>
<span class="sd">            &gt;&gt;&gt; )</span>
<span class="sd">            &gt;&gt;&gt; corpus.print_book_list()</span>
<span class="sd">            # 0 Jane Austen Emma</span>
<span class="sd">            # 1 Jane Austen Gevoel en verstand</span>
<span class="sd">            # 2 Jane Austen Emma</span>
<span class="sd">            # 3 Jane Austen Lady Susan</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: convertors: metadata -&gt; sqllite | texts -&quot; directory</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">working_directory</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">corpora_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">book_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiate a corpus class</span>
<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the corpus.</span>
<span class="sd">            working_directory (str): The working directory path</span>
<span class="sd">            description (str,optional): A description of the corpus. Default to &quot;&quot;.</span>
<span class="sd">            corpora_path (str,optional):  Path where the texts of the books in the corpus are saved. Default to None:</span>
<span class="sd">            book_list (list[dhtk.common.book.Book], optional:  A list of common.book.Book and/or child tools of it.Default to None:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>

        <span class="c1"># If there is a list of books, add the book to the list.</span>
        <span class="k">if</span> <span class="n">book_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">book</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">book_list</span> <span class="k">if</span> <span class="n">book</span><span class="p">]</span>
        <span class="c1"># If  no list, create one (creating a set in order to avoid duplication).</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If any path exist, ask for a directory and create one.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">=</span> <span class="n">corpora_path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">corpora_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">working_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;requests&quot;</span>

    <span class="c1"># Settings</span>
    <span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets and returns the path containing the text files of the books in the corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">          path(str, optional): the path dir. Default to None</span>

<span class="sd">        Returns:</span>
<span class="sd">          str: Path of corpus with the name of directory and the name of corpus.</span>
<span class="sd">          Examples:</span>

<span class="sd">        &gt;&gt;&gt; corpus.path()</span>
<span class="sd">            # &#39;~Desktop/jane_austen&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">/</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">          name(str, optional): The corpus file will be saved in the local machine with this name. (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">          str: the name of corpus.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; corpus.get_name()</span>
<span class="sd">            # &#39;jane_austen&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets and returns the description of the corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">          description(str, optional): The description of the corpus (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">          str: The description of the corpus</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; corpus.description()</span>
<span class="sd">            # &#39;Books by Jane Austen&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>

    <span class="c1"># Books</span>
    <span class="k">def</span> <span class="nf">books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the list of books in the corpus. Print list of books in the corpus.</span>
<span class="sd">        This list contains the number of books in corpus, authors&#39; full name and the books title.</span>

<span class="sd">        Args:</span>
<span class="sd">          get: Default value = False)</span>
<span class="sd">          remove: Default value = False)</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#TODO: fix the docstring</span>
        <span class="sd">&quot;&quot;&quot;</span>


<span class="sd">        Args:</span>
<span class="sd">            get:</span>
<span class="sd">            remove:</span>

<span class="sd">        Returns:</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; pprint(corpus.get_book_list())</span>
<span class="sd">            # [&lt;GutenbergBook: Jane Austen - Emma gutenberg_id: 158&gt;,</span>
<span class="sd">            # &lt;GutenbergBook: Jane Austen - Gevoel en verstand gutenberg_id: 25946&gt;,</span>
<span class="sd">            # &lt;GutenbergBook: Jane Austen - Emma gutenberg_id: 19839&gt;,</span>
<span class="sd">            #  &lt;GutenbergBook: Jane Austen - Lady Susan gutenberg_id: 22953&gt;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">get</span><span class="p">:</span>
            <span class="n">books</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">:</span> <span class="n">book</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span>
                     <span class="k">if</span> <span class="n">book</span> <span class="ow">and</span> <span class="p">(</span><span class="n">get</span> <span class="o">==</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span> <span class="ow">or</span>  <span class="c1"># Full title</span>
                                  <span class="n">get</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="ow">or</span>  <span class="c1"># Short title</span>
                                  <span class="n">get</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)}</span>  <span class="c1"># Accept all</span>
            <span class="k">if</span> <span class="n">remove</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">books</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">books</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">books</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">books</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">):</span>
                <span class="n">author</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span>
                <span class="n">author_full_name</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span>
                <span class="n">book_title</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">author_full_name</span><span class="p">,</span> <span class="n">book_title</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a single book to the corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">          book(dhtk.common.book.Book): The book instance`.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Get a single book by gutenberg id.</span>
<span class="sd">                &gt;&gt;&gt; len(corpus)</span>
<span class="sd">                # 4</span>
<span class="sd">                &gt;&gt;&gt; book = gutenberg_search.book_from_book_id(book_ids[5])</span>
<span class="sd">                &gt;&gt;&gt; corpus.add_book(book)</span>
<span class="sd">                &gt;&gt;&gt; len(corpus)</span>
<span class="sd">                # 5</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If the object is a book, add it to the corpus that already exist.</span>
        <span class="k">if</span> <span class="n">book</span> <span class="ow">and</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>

        <span class="c1"># if the object is not a book, send an error.</span>
        <span class="c1"># else:</span>
        <span class="c1">#     LOGGER.error(&quot;This is not a book.&quot;)</span>

    <span class="k">def</span> <span class="nf">add_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a list of books to the corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">          book_list(list: list: list[dhtk.common.book.Book]): A list of books instances</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; len(corpus)</span>
<span class="sd">            # 5</span>
<span class="sd">            &gt;&gt;&gt; books = [gutenberg_search.book_from_book_id(book_id) for book_id in book_ids[6:10]]</span>
<span class="sd">            &gt;&gt;&gt; corpus.add_books(books)</span>
<span class="sd">            &gt;&gt;&gt; len(corpus)</span>
<span class="sd">            # 9</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">book_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_book_file_name</span><span class="p">(</span><span class="n">book</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a good filename for a book.</span>

<span class="sd">        Args:</span>
<span class="sd">          book (dhtk.common.book.Book): It is the book from searching in gutenberg and get book id using the method `book_from_book_id()`.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a book form the corpus by deleting the book form list of books and also the file of book in the local machine.</span>

<span class="sd">        Args:</span>
<span class="sd">          book (dhtk.common.book.Book): The book to be removed</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_file_name</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all files and books in the corpus.&quot;&quot;&quot;</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">folder</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">folder</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
                <span class="n">content</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="n">folder</span><span class="o">.</span><span class="n">rmdir</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">download_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download the text file for a single book and save it into the corpus repository</span>

<span class="sd">        Args:</span>
<span class="sd">          book ((dhtk.common.book.Book): The book whose text you need to download</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">corpus_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">corpus_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">make_dirs</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">corpus_path</span> <span class="o">/</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">book</span><span class="o">.</span><span class="n">repository</span><span class="p">()</span><span class="o">.</span><span class="n">save_clean_text_file_to</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     LOGGER.info(&quot;File %s already exists in %s.&quot;, filename, corpus_path)</span>

    <span class="k">def</span> <span class="nf">download_corpus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download the text files for the full corpus to the corpus path directory.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; corpus.download_corpus()</span>
<span class="sd">            &gt;&gt;&gt; pprint(os.listdir(corpus.get_corpus_path()))</span>
<span class="sd">            # [&#39;158-gutenberg.txt&#39;,</span>
<span class="sd">            #  &#39;19839-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;121-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;22954-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;1212-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;25946-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;22962-gutenberg.txt&#39;,</span>
<span class="sd">            # &#39;22953-gutenberg.txt&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Save the original text of books</span>

        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">download_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;books_metadata.csv&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download the metadata for the full corpus into a csv file</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): the filename for the CSV file. Default to &quot;books_metadata.csv&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Save the original text of books</span>

        <span class="n">corpus_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">corpus_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">make_dirs</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>

        <span class="c1"># Save book metadata</span>
        <span class="n">pandas_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas_dataframe</span><span class="p">()</span>
        <span class="n">pandas_table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">corpus_path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Save author metadata</span>
        <span class="n">authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
            <span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">())</span>
        <span class="n">authors_meta</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
            <span class="n">authors_meta</span><span class="p">[</span><span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()]</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="n">panda_author</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">authors_meta</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">panda_author</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">panda_author</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">panda_author</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
        <span class="n">panda_author</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">corpus_path</span> <span class="o">/</span> <span class="s2">&quot;authors_metadata.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert to python dict for general purpose.&quot;&quot;&quot;</span>
        <span class="n">corpus_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">):</span>
            <span class="n">book_dict</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">book_dict</span><span class="p">[</span><span class="s2">&quot;text_file_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
            <span class="n">corpus_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">book_dict</span>
        <span class="k">return</span> <span class="n">corpus_dict</span>

    <span class="k">def</span> <span class="nf">to_pandas_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the list of books into a pandas.DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">book_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
            <span class="n">book_dict</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">book_dict</span><span class="p">[</span><span class="s2">&quot;text_file_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
            <span class="n">book_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">book_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add capability to iterate over books in corpus.</span>

<span class="sd">        Returns:</span>
<span class="sd">            iterator (iter) : An iterator over the books in the corpuse&#39;s booklist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">book</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List length.</span>

<span class="sd">        Returns:</span>
<span class="sd">            len (int): The number of books in the corpus.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert book_list in string format.</span>

<span class="sd">        Returns:</span>
<span class="sd">             str : A string of books in the list with information like the number of book in th list, author&#39;s name and the titre of book.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add padding to the authors&#39;name in order to have a clean string</span>
        <span class="n">max_author_name_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">())</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span>
        <span class="p">])</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="s2">{:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_author_name_len</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}</span><span class="se">\t</span><span class="si">{}</span><span class="s2">&quot;</span>

        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Corpus name:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Corpus description:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Corpus path:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Corpus books:&quot;</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="p">[</span><span class="n">format_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">(),</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
        <span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">)]</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the item requested.</span>

<span class="sd">        Args:</span>
<span class="sd">            item (int): The index of the book in the corpus</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The book requested</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Return the item requested.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item</code></td>
        <td><code>int</code></td>
        <td><p>The index of the book in the corpus</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The book requested</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the item requested.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (int): The index of the book in the corpus</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The book requested</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">working_directory</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">corpora_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">book_list</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Initiate a corpus class</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>Name of the corpus.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>working_directory</code></td>
        <td><code>str</code></td>
        <td><p>The working directory path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>str,optional</code></td>
        <td><p>A description of the corpus. Default to "".</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
      <tr>
        <td><code>corpora_path</code></td>
        <td><code>str,optional</code></td>
        <td><p>Path where the texts of the books in the corpus are saved. Default to None:</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>book_list</code></td>
        <td><code>list[dhtk.common.book.Book]</code></td>
        <td><p>A list of common.book.Book and/or child tools of it.Default to None:</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">working_directory</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">corpora_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">book_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initiate a corpus class</span>
<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the corpus.</span>
<span class="sd">        working_directory (str): The working directory path</span>
<span class="sd">        description (str,optional): A description of the corpus. Default to &quot;&quot;.</span>
<span class="sd">        corpora_path (str,optional):  Path where the texts of the books in the corpus are saved. Default to None:</span>
<span class="sd">        book_list (list[dhtk.common.book.Book], optional:  A list of common.book.Book and/or child tools of it.Default to None:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>

    <span class="c1"># If there is a list of books, add the book to the list.</span>
    <span class="k">if</span> <span class="n">book_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">book</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">book_list</span> <span class="k">if</span> <span class="n">book</span><span class="p">]</span>
    <span class="c1"># If  no list, create one (creating a set in order to avoid duplication).</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># If any path exist, ask for a directory and create one.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">=</span> <span class="n">corpora_path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">corpora_path</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">working_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;requests&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Add capability to iterate over books in corpus.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>iterator (iter) </code></td>
      <td><p>An iterator over the books in the corpuse's booklist.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add capability to iterate over books in corpus.</span>

<span class="sd">    Returns:</span>
<span class="sd">        iterator (iter) : An iterator over the books in the corpuse&#39;s booklist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">book</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>List length.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>len (int)</code></td>
      <td><p>The number of books in the corpus.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List length.</span>

<span class="sd">    Returns:</span>
<span class="sd">        len (int): The number of books in the corpus.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Convert book_list in string format.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str </code></td>
      <td><p>A string of books in the list with information like the number of book in th list, author's name and the titre of book.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert book_list in string format.</span>

<span class="sd">    Returns:</span>
<span class="sd">         str : A string of books in the list with information like the number of book in th list, author&#39;s name and the titre of book.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add padding to the authors&#39;name in order to have a clean string</span>
    <span class="n">max_author_name_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">())</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span>
    <span class="p">])</span> <span class="o">+</span> <span class="mi">4</span>
    <span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="s2">{:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_author_name_len</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}</span><span class="se">\t</span><span class="si">{}</span><span class="s2">&quot;</span>

    <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Corpus name:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Corpus description:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Corpus path:</span><span class="se">\n\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Corpus books:&quot;</span><span class="p">]</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="p">[</span><span class="n">format_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">(),</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
    <span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">)]</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_book" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Add a single book to the corpus.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book(dhtk.common.book.Book)</code></td>
        <td></td>
        <td><p>The book instance`.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <p>Get a single book by gutenberg id.
    &gt;&gt;&gt; len(corpus)
    # 4
    &gt;&gt;&gt; book = gutenberg_search.book_from_book_id(book_ids[5])
    &gt;&gt;&gt; corpus.add_book(book)
    &gt;&gt;&gt; len(corpus)
    # 5</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a single book to the corpus.</span>

<span class="sd">    Args:</span>
<span class="sd">      book(dhtk.common.book.Book): The book instance`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Get a single book by gutenberg id.</span>
<span class="sd">            &gt;&gt;&gt; len(corpus)</span>
<span class="sd">            # 4</span>
<span class="sd">            &gt;&gt;&gt; book = gutenberg_search.book_from_book_id(book_ids[5])</span>
<span class="sd">            &gt;&gt;&gt; corpus.add_book(book)</span>
<span class="sd">            &gt;&gt;&gt; len(corpus)</span>
<span class="sd">            # 5</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If the object is a book, add it to the corpus that already exist.</span>
    <span class="k">if</span> <span class="n">book</span> <span class="ow">and</span> <span class="n">book</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>

    <span class="c1"># if the object is not a book, send an error.</span>
    <span class="c1"># else:</span>
    <span class="c1">#     LOGGER.error(&quot;This is not a book.&quot;)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.add_books" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_list</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Add a list of books to the corpus.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book_list(list</code></td>
        <td></td>
        <td><p>list: list[dhtk.common.book.Book]): A list of books instances</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="c1"># 5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">books</span> <span class="o">=</span> <span class="p">[</span><span class="n">gutenberg_search</span><span class="o">.</span><span class="n">book_from_book_id</span><span class="p">(</span><span class="n">book_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">book_id</span> <span class="ow">in</span> <span class="n">book_ids</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">corpus</span><span class="o">.</span><span class="n">add_books</span><span class="p">(</span><span class="n">books</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="c1"># 9</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a list of books to the corpus.</span>

<span class="sd">    Args:</span>
<span class="sd">      book_list(list: list: list[dhtk.common.book.Book]): A list of books instances</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; len(corpus)</span>
<span class="sd">        # 5</span>
<span class="sd">        &gt;&gt;&gt; books = [gutenberg_search.book_from_book_id(book_id) for book_id in book_ids[6:10]]</span>
<span class="sd">        &gt;&gt;&gt; corpus.add_books(books)</span>
<span class="sd">        &gt;&gt;&gt; len(corpus)</span>
<span class="sd">        # 9</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">book_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.books" class="doc doc-heading">
<code class="highlight language-python"><span class="n">books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Returns the list of books in the corpus. Print list of books in the corpus.
This list contains the number of books in corpus, authors' full name and the books title.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>get</code></td>
        <td></td>
        <td><p>Default value = False)</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove</code></td>
        <td></td>
        <td><p>Default value = False)</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the list of books in the corpus. Print list of books in the corpus.</span>
<span class="sd">    This list contains the number of books in corpus, authors&#39; full name and the books title.</span>

<span class="sd">    Args:</span>
<span class="sd">      get: Default value = False)</span>
<span class="sd">      remove: Default value = False)</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#TODO: fix the docstring</span>
    <span class="sd">&quot;&quot;&quot;</span>


<span class="sd">    Args:</span>
<span class="sd">        get:</span>
<span class="sd">        remove:</span>

<span class="sd">    Returns:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; pprint(corpus.get_book_list())</span>
<span class="sd">        # [&lt;GutenbergBook: Jane Austen - Emma gutenberg_id: 158&gt;,</span>
<span class="sd">        # &lt;GutenbergBook: Jane Austen - Gevoel en verstand gutenberg_id: 25946&gt;,</span>
<span class="sd">        # &lt;GutenbergBook: Jane Austen - Emma gutenberg_id: 19839&gt;,</span>
<span class="sd">        #  &lt;GutenbergBook: Jane Austen - Lady Susan gutenberg_id: 22953&gt;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">get</span><span class="p">:</span>
        <span class="n">books</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">:</span> <span class="n">book</span> <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span>
                 <span class="k">if</span> <span class="n">book</span> <span class="ow">and</span> <span class="p">(</span><span class="n">get</span> <span class="o">==</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span> <span class="ow">or</span>  <span class="c1"># Full title</span>
                              <span class="n">get</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="ow">or</span>  <span class="c1"># Short title</span>
                              <span class="n">get</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)}</span>  <span class="c1"># Accept all</span>
        <span class="k">if</span> <span class="n">remove</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">books</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">books</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">books</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">books</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">):</span>
            <span class="n">author</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span>
            <span class="n">author_full_name</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span>
            <span class="n">book_title</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">author_full_name</span><span class="p">,</span> <span class="n">book_title</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.clear" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Delete all files and books in the corpus.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete all files and books in the corpus.&quot;&quot;&quot;</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">folder</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">folder</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="n">content</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="n">folder</span><span class="o">.</span><span class="n">rmdir</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.description" class="doc doc-heading">
<code class="highlight language-python"><span class="n">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Sets and returns the description of the corpus.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>description(str,</code></td>
        <td><code>optional</code></td>
        <td><p>The description of the corpus (Default value = None)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The description of the corpus</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">corpus</span><span class="o">.</span><span class="n">description</span><span class="p">()</span>
<span class="c1"># &#39;Books by Jane Austen&#39;</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets and returns the description of the corpus.</span>

<span class="sd">    Args:</span>
<span class="sd">      description(str, optional): The description of the corpus (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">      str: The description of the corpus</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; corpus.description()</span>
<span class="sd">        # &#39;Books by Jane Austen&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_book" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Download the text file for a single book and save it into the corpus repository</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book</code></td>
        <td><code>dhtk.common.book.Book</code></td>
        <td><p>The book whose text you need to download</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download the text file for a single book and save it into the corpus repository</span>

<span class="sd">    Args:</span>
<span class="sd">      book ((dhtk.common.book.Book): The book whose text you need to download</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">corpus_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">corpus_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">make_dirs</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">corpus_path</span> <span class="o">/</span> <span class="n">filename</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">book</span><span class="o">.</span><span class="n">repository</span><span class="p">()</span><span class="o">.</span><span class="n">save_clean_text_file_to</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1"># else:</span>
    <span class="c1">#     LOGGER.info(&quot;File %s already exists in %s.&quot;, filename, corpus_path)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_corpus" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_corpus</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Download the text files for the full corpus to the corpus path directory.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">corpus</span><span class="o">.</span><span class="n">download_corpus</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pprint</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">get_corpus_path</span><span class="p">()))</span>
<span class="c1"># [&#39;158-gutenberg.txt&#39;,</span>
<span class="c1">#  &#39;19839-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;121-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;22954-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;1212-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;25946-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;22962-gutenberg.txt&#39;,</span>
<span class="c1"># &#39;22953-gutenberg.txt&#39;]</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_corpus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download the text files for the full corpus to the corpus path directory.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; corpus.download_corpus()</span>
<span class="sd">        &gt;&gt;&gt; pprint(os.listdir(corpus.get_corpus_path()))</span>
<span class="sd">        # [&#39;158-gutenberg.txt&#39;,</span>
<span class="sd">        #  &#39;19839-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;121-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;22954-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;1212-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;25946-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;22962-gutenberg.txt&#39;,</span>
<span class="sd">        # &#39;22953-gutenberg.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Save the original text of books</span>

    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_book</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.download_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;books_metadata.csv&#39;</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Download the metadata for the full corpus into a csv file</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>the filename for the CSV file. Default to "books_metadata.csv"</p></td>
        <td><code>&#39;books_metadata.csv&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">download_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;books_metadata.csv&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download the metadata for the full corpus into a csv file</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): the filename for the CSV file. Default to &quot;books_metadata.csv&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Save the original text of books</span>

    <span class="n">corpus_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">corpus_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">make_dirs</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span>

    <span class="c1"># Save book metadata</span>
    <span class="n">pandas_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas_dataframe</span><span class="p">()</span>
    <span class="n">pandas_table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">corpus_path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Save author metadata</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
        <span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">get_author</span><span class="p">())</span>
    <span class="n">authors_meta</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
        <span class="n">authors_meta</span><span class="p">[</span><span class="n">author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()]</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="n">panda_author</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">authors_meta</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">panda_author</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="n">panda_author</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">panda_author</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
    <span class="n">panda_author</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">corpus_path</span> <span class="o">/</span> <span class="s2">&quot;authors_metadata.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.get_book_file_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_book_file_name</span><span class="p">(</span><span class="n">book</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Return a good filename for a book.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book</code></td>
        <td><code>dhtk.common.book.Book</code></td>
        <td><p>It is the book from searching in gutenberg and get book id using the method <code>book_from_book_id()</code>.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_book_file_name</span><span class="p">(</span><span class="n">book</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a good filename for a book.</span>

<span class="sd">    Args:</span>
<span class="sd">      book (dhtk.common.book.Book): It is the book from searching in gutenberg and get book id using the method `book_from_book_id()`.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name(str,</code></td>
        <td><code>optional</code></td>
        <td><p>The corpus file will be saved in the local machine with this name. (Default value = None)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>the name of corpus.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">corpus</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
<span class="c1"># &#39;jane_austen&#39;</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">      name(str, optional): The corpus file will be saved in the local machine with this name. (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">      str: the name of corpus.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; corpus.get_name()</span>
<span class="sd">        # &#39;jane_austen&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Sets and returns the path containing the text files of the books in the corpus.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path(str,</code></td>
        <td><code>optional</code></td>
        <td><p>the path dir. Default to None</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Path of corpus with the name of directory and the name of corpus.
Examples:</p></td>
    </tr>
  </tbody>
</table>      <blockquote>
<blockquote>
<blockquote>
<p>corpus.path()
    # '~Desktop/jane_austen'</p>
</blockquote>
</blockquote>
</blockquote>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets and returns the path containing the text files of the books in the corpus.</span>

<span class="sd">    Args:</span>
<span class="sd">      path(str, optional): the path dir. Default to None</span>

<span class="sd">    Returns:</span>
<span class="sd">      str: Path of corpus with the name of directory and the name of corpus.</span>
<span class="sd">      Examples:</span>

<span class="sd">    &gt;&gt;&gt; corpus.path()</span>
<span class="sd">        # &#39;~Desktop/jane_austen&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_corpora_path</span> <span class="o">/</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.remove_book" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Delete a book form the corpus by deleting the book form list of books and also the file of book in the local machine.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book</code></td>
        <td><code>dhtk.common.book.Book</code></td>
        <td><p>The book to be removed</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete a book form the corpus by deleting the book form list of books and also the file of book in the local machine.</span>

<span class="sd">    Args:</span>
<span class="sd">      book (dhtk.common.book.Book): The book to be removed</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_file_name</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Convert to python dict for general purpose.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert to python dict for general purpose.&quot;&quot;&quot;</span>
    <span class="n">corpus_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">book</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">):</span>
        <span class="n">book_dict</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">book_dict</span><span class="p">[</span><span class="s2">&quot;text_file_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="n">corpus_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">book_dict</span>
    <span class="k">return</span> <span class="n">corpus_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.corpus.GutenbergCorpus.to_pandas_dataframe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_pandas_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Convert the list of books into a pandas.DataFrame.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/corpus.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_pandas_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert the list of books into a pandas.DataFrame.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

    <span class="n">book_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_list</span><span class="p">:</span>
        <span class="n">book_dict</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">book_dict</span><span class="p">[</span><span class="s2">&quot;text_file_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="n">book_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">book_list</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.api.data" class="doc doc-heading">
        <code>data</code>



</h4>

    <div class="doc doc-contents ">

      <p>Contains the GutenbergData implementation of the abstract LiteraryData class</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="dhtk.data_sources.gutenberg.api.data.GutenbergData" class="doc doc-heading">
        <code>
GutenbergData            (<span title="dhtk.data_sources.templates.data.Data">Data</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Class to searching the Gutenberg catalog using SPARQL queries,
inheriting from the Abstract class LiteraryData (dhtk.data_sources.abstract_gutenberg)</p>
<p>"Query" attributes participate to create a skeleton of a standard query :
    query_header + query_select + query_head.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GutenbergData</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to searching the Gutenberg catalog using SPARQL queries,</span>
<span class="sd">    inheriting from the Abstract class LiteraryData (dhtk.data_sources.abstract_gutenberg)</span>

<span class="sd">    &quot;Query&quot; attributes participate to create a skeleton of a standard query :</span>
<span class="sd">        query_header + query_select + query_head.</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: implement different types than text! &#39;?book_id dcterms:type dcmitype:Text.&#39;</span>
    <span class="c1"># TODO: add method to search book when author is known.</span>

    <span class="n">_namespace</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
        <span class="s2">&quot;PREFIX dcterms: &lt;http://purl.org/dc/terms/&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX purl: &lt;http://purl.org/dc/terms/&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX pgterms: &lt;http://www.gutenberg.org/2009/pgterms/&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX marcrel: &lt;http://id.loc.gov/vocabulary/relators/&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PREFIX dcmitype: &lt;http://purl.org/dc/dcmitype/&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">])</span>

    <span class="n">_work_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Image&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sound&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;StillImage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Collection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MovingImage&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">_search_cache</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">_book_metadata</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&quot;&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; rdf:type ?gutenberg_type . &quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:downloads ?gutenberg_downloads .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:publisher ?gutenberg_publisher .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:hasFormat ?gutenberg_hasFormat .&quot;</span><span class="p">,</span>
                      <span class="sd">&quot;&quot;&quot;&lt;%s&gt; dcterms:language [rdf:value ?gutenberg_language] .&quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="sd">&quot;&quot;&quot;&lt;%s&gt; dcterms:subject  [rdf:valuowl:sameAse ?gutenberg_subject] .&quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="sd">&quot;&quot;&quot;&lt;%s&gt; dcterms:type [rdf:value ?gutenberg_media_type] .&quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:rights ?gutenberg_rights .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:title ?gutenberg_title .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:issued ?gutenberg_issued .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:creator ?gutenberg_creator .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:license ?gutenberg_license .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:tableOfContents ?gutenberg_tableOfContents .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc010 ?gutenberg_marc010 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc901 ?gutenberg_marc901 .&quot;</span><span class="p">,</span>
                      <span class="sd">&quot;&quot;&quot;&lt;%s&gt; pgterms:bookshelf [rdf:value ?gutenberg_bookshelf] .&quot;&quot;&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc440 ?gutenberg_marc440 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:description ?gutenberg_description .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:trl ?gutenberg_trl .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; dcterms:alternative ?gutenberg_alternative .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:edt ?gutenberg_edt .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:aui ?gutenberg_aui .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:pbl ?gutenberg_pbl .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:ill ?gutenberg_ill .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:cmm ?gutenberg_cmm .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:com ?gutenberg_com .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:oth ?gutenberg_oth .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc260 ?gutenberg_marc260 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:ctb ?gutenberg_ctb .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:ann ?gutenberg_ann .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:egr ?gutenberg_egr .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc508 ?gutenberg_marc508 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc546 ?gutenberg_marc546 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc902 ?gutenberg_marc902 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc520 ?gutenberg_marc520 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc903 ?gutenberg_marc903 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc300 ?gutenberg_marc300 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:adp ?gutenberg_adp .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:pht ?gutenberg_pht .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:unk ?gutenberg_unk .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:prt ?gutenberg_prt .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:prf ?gutenberg_prf .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc250 ?gutenberg_marc250 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:marc020 ?gutenberg_marc020 .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:cmp ?gutenberg_cmp .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:dub ?gutenberg_dub .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:arr ?gutenberg_arr .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:trc ?gutenberg_trc .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:clb ?gutenberg_clb .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:aft ?gutenberg_aft .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:res ?gutenberg_res .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; marcrel:art ?gutenberg_art .&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; owl:sameAs|foaf:isPrimaryTopicOf ?same_as  .&quot;</span><span class="p">,)</span>

    <span class="n">_author_metadata</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:alias ?aliases .&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:birthdate ?birth_date .&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:deathdate ?death_date .&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; owl:sameAs|foaf:isPrimaryTopicOf ?same_as .&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; pgterms:webpage ?web_pages .&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; rdf:type ?gutenberg_type .&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparql_endpoint</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize tools with the SPARQL endpoint,</span>
<span class="sd">        such as an local instance of the Apache Jena Fuseki server.</span>

<span class="sd">        Args:</span>
<span class="sd">            sparql_endpoint (str) : URL of the triplet store containing Gutenberg Catalog triplets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sparql_endpoint</span> <span class="o">=</span> <span class="n">SPARQLWrapper</span><span class="p">(</span><span class="n">sparql_endpoint</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Check the sparql_endpoint you provided!: </span><span class="si">{</span><span class="n">sparql_endpoint</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">error</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUTENBERG: GutenbergData instantiated using SPARQL endpoint: </span><span class="si">{</span><span class="n">sparql_endpoint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Bookshelves</span>
    <span class="n">_shelves</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;?book_id pgterms:bookshelf [dcterms:title ?bookshelf] .&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">all_bookshelves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?bookshelf&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all bookshelves in the store.</span>

<span class="sd">        This method doesn&#39;t use the standard SPARQL query, but a specific to get only bookshelves.</span>

<span class="sd">        Args:</span>
<span class="sd">          select (str) : SPARQL query   (Default value = &quot;SELECT DISTINCT ?bookshelf&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the results for the query</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_shelves</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">                ORDER BY ?bookshelf</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;bookshelf&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">search_by_bookshelf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookshelf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books corresponding to the given bookshelf string.</span>

<span class="sd">        The bookshelf is used as parameter in a SPARQL query.</span>

<span class="sd">        Args:</span>
<span class="sd">          bookshelf(str): bookshelf in plain text, case-insensitive. It can be a part of the bookshelf.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: result of the query</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUTENBERG: Searching bookshelf: </span><span class="si">{</span><span class="n">bookshelf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_shelves</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                FILTER CONTAINS(lcase(str(?bookshelf)), &quot;</span><span class="si">{</span><span class="n">bookshelf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2">   </span>
<span class="s2">                OPTIONAL </span><span class="se">{{</span><span class="s2"> ?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2">             </span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?author ?title</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="c1"># Subjects</span>
    <span class="n">_subjects</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;?book_id dcterms:subject [dcterms:title ?subject].&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">all_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?subject&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all subjects in the store.</span>

<span class="sd">        This method don&#39;t use the standard SPARQL query, but a specific to get only subjects.</span>

<span class="sd">        Args:</span>
<span class="sd">          select (str): The SPARQL query  (Default value = &quot;SELECT DISTINCT ?subject&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : a list with the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subjects</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?subject</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">search_by_subject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books with given subject string.</span>

<span class="sd">        The subject is used as parameter in a SPARQL query. If no limit value is specified,</span>
<span class="sd">        the method returns all books with the given subject.</span>

<span class="sd">        Args:</span>
<span class="sd">          subject(str): Subject in plain text, case-insensitive. It can be a part of the subject.</span>
<span class="sd">          limit(int, optional): Use to limit how many books are returned by the SPARQL query. (Default value = 0)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subjects</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                        FILTER CONTAINS(lcase(str(?subject)), &quot;</span><span class="si">{</span><span class="n">subject</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                        </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2">   </span>
<span class="s2">                        OPTIONAL </span><span class="se">{{</span><span class="s2"> ?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2">          </span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">                    ORDER BY ?author ?title</span>
<span class="s2">                    &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;LIMIT </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="c1"># Authors</span>
    <span class="n">_authors</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;?author_id a	pgterms:agent;</span>
<span class="s2">                  pgterms:name|pgterms:alias ?author.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">all_authors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?author&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all authors in the store.</span>

<span class="sd">        This method don&#39;t use the standard SPARQL query, but a specific to get only authors.</span>

<span class="sd">        Args:</span>
<span class="sd">      select (str): The SPARQL query  (Default value = &quot;SELECT DISTINCT ?author&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?author</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">search_by_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Data books in the Gutenberg catalog by author&#39;s name and last name. The standard SPARQL query is overwritten by a filter and by a sort instruction.</span>

<span class="sd">        Args:</span>
<span class="sd">          name(str): Author&#39;s name, first name, last name or alias in plain text, case-insensitive. It can be a part of the author&#39;s name. (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If alias is provided, looks for name AND alias</span>
        <span class="c1"># Otherwise assume the name might be an alias</span>

        <span class="n">names</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\W+&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;FILTER (CONTAINS(lcase(str(?author)), &quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
            <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; ||  CONTAINS(lcase(str(?aliases)), &quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
            <span class="nb">filter</span> <span class="o">+=</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">aliases</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\W+&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">aliases</span><span class="p">:</span>
                <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;FILTER (CONTAINS(lcase(str(?aliases)), &quot;</span><span class="si">{</span><span class="n">alias</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;))</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?author ?aliases ?author_id&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;   </span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="nb">filter</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                OPTIONAL </span><span class="se">{{</span><span class="s2"> ?author_id pgterms:alias ?aliases. </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?author</span>
<span class="s2">            &quot;&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an author object with information collected from the Gutenberg Store.</span>

<span class="sd">        Args:</span>
<span class="sd">          id(str): The author identifier is an URI, like &#39;http://www.gutenberg.org/2009/agents/408&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                &lt;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&gt; pgterms:name ?name . </span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">author</span> <span class="o">=</span> <span class="n">GutenbergAuthor</span><span class="p">(</span>
            <span class="n">gutenberg_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">query</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">author</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">author</span><span class="p">))</span>
        <span class="n">author</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">({</span><span class="s2">&quot;bibliography&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bibliography</span><span class="p">(</span><span class="nb">id</span><span class="p">)})</span>
        <span class="k">return</span> <span class="n">author</span>

    <span class="k">def</span> <span class="nf">get_bibliography</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;To get all books written by an author.</span>

<span class="sd">        Args:</span>
<span class="sd">          id(str): The author identifier is an URI, like &#39;http://www.gutenberg.org/2009/agents/408&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?title&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                ?book_id purl:creator &lt;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&gt; .</span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?title</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)]</span>

    <span class="c1"># Books</span>
    <span class="n">_books</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;?book_id purl:title ?title.</span>
<span class="s2">                </span><span class="si">{</span><span class="n">_authors</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">all_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?title ?author&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the title of all books in the store.</span>

<span class="sd">        This method don&#39;t use the standard query, but a specific to get only</span>
<span class="sd">        titles and book identifiers.</span>

<span class="sd">        Args:</span>
<span class="sd">          select:  (Default value = &quot;SELECT DISTINCT ?title ?author&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?title</span>
<span class="s2">          &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">search_by_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books with given title string.</span>

<span class="sd">        Args:</span>
<span class="sd">          title(str): Title in plain text, case-insensitive. It can be a part of the title.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?book_id ?title ?author_id ?author ?language&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">              </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">              OPTIONAL </span><span class="se">{{</span><span class="s2">?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2"></span>
<span class="s2">              FILTER CONTAINS(lcase(str(?title)), </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?author ?title</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a book object with information collected from the Gutenberg Store.</span>

<span class="sd">        Args:</span>
<span class="sd">          book_id(str): The book identifier is a URI, like &#39;http://www.gutenberg.org/ebooks/20063&#39;</span>
<span class="sd">          author:  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            gutenberg.tools.book :  A book object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                &lt;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">&gt; purl:title ?title; </span>
<span class="s2">                    purl:creator ?author_id;</span>
<span class="s2">                    dcterms:type dcmitype:Text.          </span>
<span class="s2">            </span><span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">book</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="n">author</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_author</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;author_id&quot;</span><span class="p">])</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bookshelves_subjects</span><span class="p">(</span><span class="n">book_id</span><span class="p">)</span>

        <span class="n">book</span> <span class="o">=</span> <span class="n">GutenbergBook</span><span class="p">(</span>
            <span class="n">gutenberg_id</span><span class="o">=</span><span class="n">book_id</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span>
            <span class="n">subject</span><span class="o">=</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;subjects&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">bookshelf</span><span class="o">=</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;bookshelves&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="n">author</span>
        <span class="p">)</span>
        <span class="n">book</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">book</span>

    <span class="k">def</span> <span class="nf">bookshelves_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the bookshelves and the subjects of the given book, designated by his identifier.</span>

<span class="sd">        Args:</span>
<span class="sd">          book_id(str): A Gutenberg book identifier. Is a URI, like &quot;http://www.gutenberg.org/ebooks/10053&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict : the query results with &#39;bookshelves&#39; and &#39;subjects&#39;</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?subject ?bookshelf&quot;</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                &lt;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">&gt; dcterms:subject [dcterms:title ?subject];</span>
<span class="s2">                    pgterms:bookshelf [dcterms:title ?bookshelf] ;</span>
<span class="s2">                    dcterms:type dcmitype:Text.                             </span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?subject</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>
        <span class="n">bookshelves</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;bookshelf&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;bookshelves&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">bookshelves</span><span class="p">),</span> <span class="s2">&quot;subjects&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">subjects</span><span class="p">)}</span>

    <span class="c1"># Queries</span>
    <span class="k">def</span> <span class="nf">_get_query_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use a SPARQL query to get results from the triplet store.</span>

<span class="sd">        Args:</span>
<span class="sd">          query(str): A structured string in the SPARQL language used to ask the triplet store.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUTENBERG: Executing query: </span><span class="se">\n</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">sparql</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sparql_endpoint</span>

        <span class="n">sparql</span><span class="o">.</span><span class="n">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">sparql</span><span class="o">.</span><span class="n">setReturnFormat</span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span>
        <span class="c1"># TODO: handle remote server better than this, please:</span>
        <span class="n">query_results</span> <span class="o">=</span> <span class="n">sparql</span><span class="o">.</span><span class="n">queryAndConvert</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">query_results</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="s2">&quot;bindings&quot;</span><span class="p">]:</span>
            <span class="n">formatted_entry</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">formatted_entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">formatted_entry</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get metadata about the book that is present in the catalog.</span>

<span class="sd">        Args:</span>
<span class="sd">          item(An object having an entry &quot;gutenberg_id&quot; in the results of the method get_metadata().): The metadata of these tools must contain an entry called: &quot;gutenberg_id&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict : the query results</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">query_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_query</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query_results</span><span class="p">:</span>
            <span class="n">result_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">result_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">metadata</span>

    <span class="k">def</span> <span class="nf">_metadata_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function to get metadata for different item types.</span>

<span class="sd">        Args:</span>
<span class="sd">          item(An object having an entry &quot;gutenberg_id&quot; in the results of the method get_metadata().): The metadata of these tools must contain an entry called: &quot;gutenberg_id&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : the query results</span>

<span class="sd">        TODO: fix this! One query should be sufficent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span>
        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; SELECT DISTINCT *</span>
<span class="s2">            WHERE {</span>
<span class="s2">            &quot;&quot;&quot;</span>
        <span class="n">query_results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">GutenbergBook</span><span class="p">):</span>
            <span class="n">book_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_book_id</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_book_metadata</span><span class="p">:</span>
                <span class="n">query_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span> <span class="o">+</span> <span class="n">metadata</span> <span class="o">%</span> <span class="n">book_id</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">query_results</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">GutenbergAuthor</span><span class="p">):</span>
            <span class="n">author_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_author_metadata</span><span class="p">:</span>
                <span class="n">query_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span> <span class="o">+</span> <span class="n">metadata</span> <span class="o">%</span> <span class="n">author_id</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">query_results</span>

    <span class="k">def</span> <span class="nf">statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print information about the Gutenberg catalog.</span>

<span class="sd">        Args:</span>

<span class="sd">        Returns:</span>
<span class="sd">          str: Formatted string of different statistics. Subject counts sub-subjects too.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method is relatively slow due to the fact that it inspects the whole Gutenberg RDF.</span>

<span class="sd">        Examples:</span>

<span class="sd">            &gt;&gt;&gt; gutenberg_data.statistics()</span>
<span class="sd">            # number of books        :     60101</span>
<span class="sd">            # number of authors      :     20908</span>
<span class="sd">            # number of bookshelves  :       335</span>
<span class="sd">            # number of subjects     :     17524</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">statistics</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_books&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_books</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?title) as ?total)&quot;</span><span class="p">)</span>
        <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_authors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_authors</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?author) as ?total)&quot;</span><span class="p">)</span>
        <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_bookshelves&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_bookshelves</span><span class="p">(</span>
            <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?bookshelf) as ?total)&quot;</span><span class="p">)</span>
        <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_subjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_subjects</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?subject) as ?total)&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">statistics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">23</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparql_endpoint</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Initialize tools with the SPARQL endpoint,
such as an local instance of the Apache Jena Fuseki server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>sparql_endpoint</code></td>
        <td><code>str) </code></td>
        <td><p>URL of the triplet store containing Gutenberg Catalog triplets.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparql_endpoint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize tools with the SPARQL endpoint,</span>
<span class="sd">    such as an local instance of the Apache Jena Fuseki server.</span>

<span class="sd">    Args:</span>
<span class="sd">        sparql_endpoint (str) : URL of the triplet store containing Gutenberg Catalog triplets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sparql_endpoint</span> <span class="o">=</span> <span class="n">SPARQLWrapper</span><span class="p">(</span><span class="n">sparql_endpoint</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Check the sparql_endpoint you provided!: </span><span class="si">{</span><span class="n">sparql_endpoint</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span> <span class="nn">error</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUTENBERG: GutenbergData instantiated using SPARQL endpoint: </span><span class="si">{</span><span class="n">sparql_endpoint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.all_authors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_authors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;SELECT DISTINCT ?author&#39;</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return all authors in the store.</p>
<p>This method don't use the standard SPARQL query, but a specific to get only authors.</p>
<p>Args:
select (str): The SPARQL query  (Default value = "SELECT DISTINCT ?author")</p>
<p>!!! returns
      list : the query results</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">all_authors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?author&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all authors in the store.</span>

<span class="sd">    This method don&#39;t use the standard SPARQL query, but a specific to get only authors.</span>

<span class="sd">    Args:</span>
<span class="sd">  select (str): The SPARQL query  (Default value = &quot;SELECT DISTINCT ?author&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?author</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.all_books" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;SELECT DISTINCT ?title ?author&#39;</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return the title of all books in the store.</p>
<p>This method don't use the standard query, but a specific to get only
titles and book identifiers.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>select</code></td>
        <td></td>
        <td><p>(Default value = "SELECT DISTINCT ?title ?author")</p></td>
        <td><code>&#39;SELECT DISTINCT ?title ?author&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">all_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?title ?author&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the title of all books in the store.</span>

<span class="sd">    This method don&#39;t use the standard query, but a specific to get only</span>
<span class="sd">    titles and book identifiers.</span>

<span class="sd">    Args:</span>
<span class="sd">      select:  (Default value = &quot;SELECT DISTINCT ?title ?author&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?title</span>
<span class="s2">      &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.all_bookshelves" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_bookshelves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;SELECT DISTINCT ?bookshelf&#39;</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return all bookshelves in the store.</p>
<p>This method doesn't use the standard SPARQL query, but a specific to get only bookshelves.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>select</code></td>
        <td><code>str) </code></td>
        <td><p>SPARQL query   (Default value = "SELECT DISTINCT ?bookshelf")</p></td>
        <td><code>&#39;SELECT DISTINCT ?bookshelf&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list </code></td>
      <td><p>the results for the query</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">all_bookshelves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?bookshelf&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all bookshelves in the store.</span>

<span class="sd">    This method doesn&#39;t use the standard SPARQL query, but a specific to get only bookshelves.</span>

<span class="sd">    Args:</span>
<span class="sd">      select (str) : SPARQL query   (Default value = &quot;SELECT DISTINCT ?bookshelf&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : the results for the query</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_shelves</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">            ORDER BY ?bookshelf</span>
<span class="s2">            &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;bookshelf&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.all_subjects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;SELECT DISTINCT ?subject&#39;</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return all subjects in the store.</p>
<p>This method don't use the standard SPARQL query, but a specific to get only subjects.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>select</code></td>
        <td><code>str</code></td>
        <td><p>The SPARQL query  (Default value = "SELECT DISTINCT ?subject")</p></td>
        <td><code>&#39;SELECT DISTINCT ?subject&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list </code></td>
      <td><p>a list with the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">all_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT DISTINCT ?subject&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subjects in the store.</span>

<span class="sd">    This method don&#39;t use the standard SPARQL query, but a specific to get only subjects.</span>

<span class="sd">    Args:</span>
<span class="sd">      select (str): The SPARQL query  (Default value = &quot;SELECT DISTINCT ?subject&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : a list with the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subjects</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?subject</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;COUNT&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.bookshelves_subjects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bookshelves_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return the bookshelves and the subjects of the given book, designated by his identifier.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book_id(str)</code></td>
        <td></td>
        <td><p>A Gutenberg book identifier. Is a URI, like "http://www.gutenberg.org/ebooks/10053"</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict </code></td>
      <td><p>the query results with 'bookshelves' and 'subjects'</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bookshelves_subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the bookshelves and the subjects of the given book, designated by his identifier.</span>

<span class="sd">    Args:</span>
<span class="sd">      book_id(str): A Gutenberg book identifier. Is a URI, like &quot;http://www.gutenberg.org/ebooks/10053&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict : the query results with &#39;bookshelves&#39; and &#39;subjects&#39;</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?subject ?bookshelf&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            &lt;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">&gt; dcterms:subject [dcterms:title ?subject];</span>
<span class="s2">                pgterms:bookshelf [dcterms:title ?bookshelf] ;</span>
<span class="s2">                dcterms:type dcmitype:Text.                             </span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?subject</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>
    <span class="n">bookshelves</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;bookshelf&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;bookshelves&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">bookshelves</span><span class="p">),</span> <span class="s2">&quot;subjects&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">subjects</span><span class="p">)}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.get_author" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Create an author object with information collected from the Gutenberg Store.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>id(str)</code></td>
        <td></td>
        <td><p>The author identifier is an URI, like 'http://www.gutenberg.org/2009/agents/408'</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an author object with information collected from the Gutenberg Store.</span>

<span class="sd">    Args:</span>
<span class="sd">      id(str): The author identifier is an URI, like &#39;http://www.gutenberg.org/2009/agents/408&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            &lt;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&gt; pgterms:name ?name . </span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">author</span> <span class="o">=</span> <span class="n">GutenbergAuthor</span><span class="p">(</span>
        <span class="n">gutenberg_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">query</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">author</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">author</span><span class="p">))</span>
    <span class="n">author</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">({</span><span class="s2">&quot;bibliography&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bibliography</span><span class="p">(</span><span class="nb">id</span><span class="p">)})</span>
    <span class="k">return</span> <span class="n">author</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.get_bibliography" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_bibliography</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>To get all books written by an author.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>id(str)</code></td>
        <td></td>
        <td><p>The author identifier is an URI, like 'http://www.gutenberg.org/2009/agents/408'</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_bibliography</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;To get all books written by an author.</span>

<span class="sd">    Args:</span>
<span class="sd">      id(str): The author identifier is an URI, like &#39;http://www.gutenberg.org/2009/agents/408&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?title&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            ?book_id purl:creator &lt;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&gt; .</span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?title</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.get_book" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Create a book object with information collected from the Gutenberg Store.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>book_id(str)</code></td>
        <td></td>
        <td><p>The book identifier is a URI, like 'http://www.gutenberg.org/ebooks/20063'</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>author</code></td>
        <td></td>
        <td><p>(Default value = None)</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>gutenberg.tools.book </code></td>
      <td><p>A book object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a book object with information collected from the Gutenberg Store.</span>

<span class="sd">    Args:</span>
<span class="sd">      book_id(str): The book identifier is a URI, like &#39;http://www.gutenberg.org/ebooks/20063&#39;</span>
<span class="sd">      author:  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        gutenberg.tools.book :  A book object</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            &lt;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">&gt; purl:title ?title; </span>
<span class="s2">                purl:creator ?author_id;</span>
<span class="s2">                dcterms:type dcmitype:Text.          </span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="n">book</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
        <span class="n">author</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_author</span><span class="p">(</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;author_id&quot;</span><span class="p">])</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bookshelves_subjects</span><span class="p">(</span><span class="n">book_id</span><span class="p">)</span>

    <span class="n">book</span> <span class="o">=</span> <span class="n">GutenbergBook</span><span class="p">(</span>
        <span class="n">gutenberg_id</span><span class="o">=</span><span class="n">book_id</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">book</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span>
        <span class="n">subject</span><span class="o">=</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;subjects&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bookshelf</span><span class="o">=</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;bookshelves&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">author</span><span class="o">=</span><span class="n">author</span>
    <span class="p">)</span>
    <span class="n">book</span><span class="o">.</span><span class="n">update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">book</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">book</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.get_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Get metadata about the book that is present in the catalog.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item(An</code></td>
        <td><code>object having an entry &#34;gutenberg_id&#34; in the results of the method get_metadata().</code></td>
        <td><p>The metadata of these tools must contain an entry called: "gutenberg_id"</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get metadata about the book that is present in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">      item(An object having an entry &quot;gutenberg_id&quot; in the results of the method get_metadata().): The metadata of these tools must contain an entry called: &quot;gutenberg_id&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">query_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_query</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">query_results</span><span class="p">:</span>
        <span class="n">result_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">result_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_author" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_by_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Data books in the Gutenberg catalog by author's name and last name. The standard SPARQL query is overwritten by a filter and by a sort instruction.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name(str)</code></td>
        <td></td>
        <td><p>Author's name, first name, last name or alias in plain text, case-insensitive. It can be a part of the author's name. (Default value = None)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_by_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Data books in the Gutenberg catalog by author&#39;s name and last name. The standard SPARQL query is overwritten by a filter and by a sort instruction.</span>

<span class="sd">    Args:</span>
<span class="sd">      name(str): Author&#39;s name, first name, last name or alias in plain text, case-insensitive. It can be a part of the author&#39;s name. (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If alias is provided, looks for name AND alias</span>
    <span class="c1"># Otherwise assume the name might be an alias</span>

    <span class="n">names</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\W+&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="nb">filter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;FILTER (CONTAINS(lcase(str(?author)), &quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
        <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; ||  CONTAINS(lcase(str(?aliases)), &quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
        <span class="nb">filter</span> <span class="o">+=</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">aliases</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\W+&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">aliases</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;FILTER (CONTAINS(lcase(str(?aliases)), &quot;</span><span class="si">{</span><span class="n">alias</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;))</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?author ?aliases ?author_id&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;   </span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_authors</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="nb">filter</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            OPTIONAL </span><span class="se">{{</span><span class="s2"> ?author_id pgterms:alias ?aliases. </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?author</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_bookshelf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_by_bookshelf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookshelf</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Data in Gutenberg catalog all books corresponding to the given bookshelf string.</p>
<p>The bookshelf is used as parameter in a SPARQL query.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bookshelf(str)</code></td>
        <td></td>
        <td><p>bookshelf in plain text, case-insensitive. It can be a part of the bookshelf.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>result of the query</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_by_bookshelf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookshelf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books corresponding to the given bookshelf string.</span>

<span class="sd">    The bookshelf is used as parameter in a SPARQL query.</span>

<span class="sd">    Args:</span>
<span class="sd">      bookshelf(str): bookshelf in plain text, case-insensitive. It can be a part of the bookshelf.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: result of the query</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUTENBERG: Searching bookshelf: </span><span class="si">{</span><span class="n">bookshelf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_shelves</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            FILTER CONTAINS(lcase(str(?bookshelf)), &quot;</span><span class="si">{</span><span class="n">bookshelf</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2">   </span>
<span class="s2">            OPTIONAL </span><span class="se">{{</span><span class="s2"> ?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2">             </span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?author ?title</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_subject" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_by_subject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Data in Gutenberg catalog all books with given subject string.</p>
<p>The subject is used as parameter in a SPARQL query. If no limit value is specified,
the method returns all books with the given subject.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>subject(str)</code></td>
        <td></td>
        <td><p>Subject in plain text, case-insensitive. It can be a part of the subject.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>limit(int,</code></td>
        <td><code>optional</code></td>
        <td><p>Use to limit how many books are returned by the SPARQL query. (Default value = 0)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_by_subject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books with given subject string.</span>

<span class="sd">    The subject is used as parameter in a SPARQL query. If no limit value is specified,</span>
<span class="sd">    the method returns all books with the given subject.</span>

<span class="sd">    Args:</span>
<span class="sd">      subject(str): Subject in plain text, case-insensitive. It can be a part of the subject.</span>
<span class="sd">      limit(int, optional): Use to limit how many books are returned by the SPARQL query. (Default value = 0)</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT *&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">                    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subjects</span><span class="si">}</span><span class="s2"></span>
<span class="s2">                    FILTER CONTAINS(lcase(str(?subject)), &quot;</span><span class="si">{</span><span class="n">subject</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;)</span>
<span class="s2">                    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2">   </span>
<span class="s2">                    OPTIONAL </span><span class="se">{{</span><span class="s2"> ?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2">          </span>
<span class="s2">                </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">                ORDER BY ?author ?title</span>
<span class="s2">                &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="k">if</span> <span class="n">limit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;LIMIT </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.search_by_title" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search_by_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Data in Gutenberg catalog all books with given title string.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>title(str)</code></td>
        <td></td>
        <td><p>Title in plain text, case-insensitive. It can be a part of the title.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str </code></td>
      <td><p>the query results</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">search_by_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data in Gutenberg catalog all books with given title string.</span>

<span class="sd">    Args:</span>
<span class="sd">      title(str): Title in plain text, case-insensitive. It can be a part of the title.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : the query results</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">select</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT ?book_id ?title ?author_id ?author ?language&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        WHERE </span><span class="se">{{</span><span class="s2"></span>
<span class="s2">          </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_books</span><span class="si">}</span><span class="s2"></span>
<span class="s2">          OPTIONAL </span><span class="se">{{</span><span class="s2">?book_id dcterms:language [rdf:value ?language].</span><span class="se">}}</span><span class="s2"></span>
<span class="s2">          FILTER CONTAINS(lcase(str(?title)), </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2"></span>
<span class="s2">        ORDER BY ?author ?title</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace</span> <span class="o">+</span> <span class="n">select</span> <span class="o">+</span> <span class="n">pattern</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_results</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.api.data.GutenbergData.statistics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Print information about the Gutenberg catalog.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Formatted string of different statistics. Subject counts sub-subjects too.</p></td>
    </tr>
  </tbody>
</table>      <p>!!! notes
    This method is relatively slow due to the fact that it inspects the whole Gutenberg RDF.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">gutenberg_data</span><span class="o">.</span><span class="n">statistics</span><span class="p">()</span>
<span class="c1"># number of books        :     60101</span>
<span class="c1"># number of authors      :     20908</span>
<span class="c1"># number of bookshelves  :       335</span>
<span class="c1"># number of subjects     :     17524</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/api/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print information about the Gutenberg catalog.</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>
<span class="sd">      str: Formatted string of different statistics. Subject counts sub-subjects too.</span>

<span class="sd">    Notes:</span>
<span class="sd">        This method is relatively slow due to the fact that it inspects the whole Gutenberg RDF.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; gutenberg_data.statistics()</span>
<span class="sd">        # number of books        :     60101</span>
<span class="sd">        # number of authors      :     20908</span>
<span class="sd">        # number of bookshelves  :       335</span>
<span class="sd">        # number of subjects     :     17524</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">statistics</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_books&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_books</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?title) as ?total)&quot;</span><span class="p">)</span>
    <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_authors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_authors</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?author) as ?total)&quot;</span><span class="p">)</span>
    <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_bookshelves&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_bookshelves</span><span class="p">(</span>
        <span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?bookshelf) as ?total)&quot;</span><span class="p">)</span>
    <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;number_of_subjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_subjects</span><span class="p">(</span><span class="n">select</span><span class="o">=</span><span class="s2">&quot;SELECT (COUNT(DISTINCT ?subject) as ?total)&quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">statistics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">23</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="dhtk.data_sources.gutenberg.data" class="doc doc-heading">
        <code>data</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.data.builder" class="doc doc-heading">
        <code>builder</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="dhtk.data_sources.gutenberg.data.builder.get_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>self</code></td>
        <td></td>
        <td></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/data/builder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        self:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MANAGERS</span><span class="o">.</span><span class="n">SYSTEM</span><span class="o">.</span><span class="n">download_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">,</span>
                                        <span class="n">configuration</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;downloads&quot;</span><span class="p">,</span> <span class="s2">&quot;setting&quot;</span><span class="p">:</span> <span class="s2">&quot;gutenberg&quot;</span><span class="p">},</span>
                                        <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Downloading Gutenberg.org metadata&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MANAGERS</span><span class="o">.</span><span class="n">SYSTEM</span><span class="o">.</span><span class="n">unpack_archive</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
                                                          <span class="n">configuration</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;gutenberg&quot;</span><span class="p">,</span> <span class="s2">&quot;setting&quot;</span><span class="p">:</span> <span class="s2">&quot;books&quot;</span><span class="p">},</span>
                                                          <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Unpacking Gutenberg.org metadata&quot;</span><span class="p">,</span>
                                                          <span class="n">archive_type</span><span class="o">=</span><span class="s2">&quot;r:bz2&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_process_graph</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MANAGERS</span><span class="o">.</span><span class="n">SYSTEM</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MANAGERS</span><span class="o">.</span><span class="n">SYSTEM</span><span class="o">.</span><span class="n">unpacked_files</span><span class="p">),</span> <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="dhtk.data_sources.gutenberg.data.builder.owl_test" class="doc doc-heading">
<code class="highlight language-python"><span class="n">owl_test</span><span class="p">()</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Trying to automatically extract class information from triples</p>
<p>check:
https://gitlab.com/neves.ces/bnf_project/-/blob/d3d2d1b40d7c6243481c4bf97bc48184e358d905/Gutenberg_process.ipynb</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/data/builder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">owl_test</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Trying to automatically extract class information from triples</span>

<span class="sd">    check:</span>
<span class="sd">    https://gitlab.com/neves.ces/bnf_project/-/blob/d3d2d1b40d7c6243481c4bf97bc48184e358d905/Gutenberg_process.ipynb</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">owlready2</span>
    <span class="n">onto</span> <span class="o">=</span> <span class="n">owlready2</span><span class="o">.</span><span class="n">get_ontology</span><span class="p">(</span><span class="n">base_iri</span><span class="o">=</span><span class="s2">&quot;master.rdf&quot;</span><span class="p">)</span>
    <span class="n">onto</span><span class="o">.</span><span class="n">_load</span><span class="p">()</span>
    <span class="n">get_ontology</span><span class="p">(</span><span class="s2">&quot;master.rdf#&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">onto</span><span class="p">:</span>
        <span class="k">class</span> <span class="nc">Drug</span><span class="p">(</span><span class="n">owlready2</span><span class="o">.</span><span class="n">Thing</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
            <span class="k">pass</span>

    <span class="c1"># Class constructors</span>
    <span class="k">def</span> <span class="nf">constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">          arg: </span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructor_arg</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="k">def</span> <span class="nf">define_class</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">          name: </span>
<span class="sd">          arg: </span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">onto</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">owlready2</span><span class="o">.</span><span class="n">Thing</span><span class="p">,),</span> <span class="p">{</span><span class="s2">&quot;__init__&quot;</span><span class="p">:</span> <span class="n">constructor</span><span class="p">})</span>

    <span class="n">define_class</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">onto</span><span class="o">.</span><span class="n">classes</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="dhtk.data_sources.gutenberg.data.builder.serialize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">n_files</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;master.rdf&#39;</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>graph</code></td>
        <td></td>
        <td></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_files</code></td>
        <td></td>
        <td></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_name</code></td>
        <td></td>
        <td><p>(Default value = "master.rdf")</p></td>
        <td><code>&#39;master.rdf&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/data/builder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">n_files</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;master.rdf&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">      graph: </span>
<span class="sd">      n_files: </span>
<span class="sd">      file_name:  (Default value = &quot;master.rdf&quot;)</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> triples merged from </span><span class="si">{}</span><span class="s2"> RDF graphs&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">),</span> <span class="n">n_files</span><span class="p">))</span>

    <span class="n">graph</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">destination</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span> <span class="o">/</span> <span class="n">file_name</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;xml&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span> <span class="o">/</span> <span class="n">file_name</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="dhtk.data_sources.gutenberg.data.builder.unpack_archive" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unpack_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="o">=&lt;</span><span class="n">Graph</span> <span class="n">identifier</span><span class="o">=</span><span class="n">N706aa1ef48b34bbaa288f4a3b27fad93</span> <span class="p">(</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">rdflib</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span><span class="s1">&#39;&gt;)&gt;, configuration=None, desc=&#39;</span><span class="n">Unpacking</span> <span class="n">archive</span><span class="s1">&#39;, archive_type=&#39;</span><span class="n">r</span><span class="p">:</span><span class="n">bz2</span><span class="s1">&#39;)</span></code>


</h5>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>g</code></td>
        <td><code>rdflib.Graph</code></td>
        <td><p>The graph where unpack  (Default value = rdflib.Graph())</p></td>
        <td><code>&lt;Graph identifier=N706aa1ef48b34bbaa288f4a3b27fad93 (&lt;class &#39;rdflib.graph.Graph&#39;&gt;)&gt;</code></td>
      </tr>
      <tr>
        <td><code>configuration</code></td>
        <td><code>str</code></td>
        <td><p>Configuration settings   (Default value = None)</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>desc</code></td>
        <td><code>str</code></td>
        <td><p>The description of the work  (Default value = "Unpacking archive")</p></td>
        <td><code>&#39;Unpacking archive&#39;</code></td>
      </tr>
      <tr>
        <td><code>archive_type</code></td>
        <td><code>str</code></td>
        <td><p>the suffix extension   (Default value = "r:bz2")</p></td>
        <td><code>&#39;r:bz2&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>g (rdflib.Graph)</code></td>
      <td><p>The graph
log ( logging): The log file</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/data/builder.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">unpack_archive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">rdflib</span><span class="o">.</span><span class="n">Graph</span><span class="p">(),</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Unpacking archive&quot;</span><span class="p">,</span> <span class="n">archive_type</span><span class="o">=</span><span class="s2">&quot;r:bz2&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">      g (rdflib.Graph): The graph where unpack  (Default value = rdflib.Graph())</span>
<span class="sd">      configuration (str): Configuration settings   (Default value = None)</span>
<span class="sd">      desc (str): The description of the work  (Default value = &quot;Unpacking archive&quot;)</span>
<span class="sd">      archive_type (str): the suffix extension   (Default value = &quot;r:bz2&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        g (rdflib.Graph): The graph</span>
<span class="sd">        log ( logging): The log file</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">configuration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">configuration</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;downloads&quot;</span><span class="p">,</span> <span class="s2">&quot;setting&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">}</span>

    <span class="c1"># Capture rdflib.graph.parse logs to identify broken URIs</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;rdflib.term&quot;</span><span class="p">)</span>
    <span class="n">log_capture_string</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">log_capture_string</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

    <span class="n">file_names</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">archive</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_download</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Opening </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">archive</span><span class="p">))</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="n">archive_type</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">tar</span><span class="o">.</span><span class="n">getmembers</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">):</span>
            <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Cleans the folder structure</span>
            <span class="n">tar</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">)</span>

            <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_graphs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span> <span class="o">/</span> <span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

            <span class="n">file_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Removing </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">archive</span><span class="p">))</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">([</span><span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="n">archive</span><span class="p">])</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">log_capture_string</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="c1"># Save to config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MANAGERS</span><span class="o">.</span><span class="n">CONFIG</span><span class="o">.</span><span class="n">add_record</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">file_names</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unpacked_files</span> <span class="o">=</span> <span class="n">file_names</span>

    <span class="k">return</span> <span class="n">g</span><span class="p">,</span> <span class="n">log</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="dhtk.data_sources.gutenberg.tools" class="doc doc-heading">
        <code>tools</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.tools.author" class="doc doc-heading">
        <code>author</code>



</h4>

    <div class="doc doc-contents ">

      <p>Contains the GutenbergAuthor Class.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor" class="doc doc-heading">
        <code>
GutenbergAuthor            (<span title="dhtk.data_sources.templates.author.Author">Author</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>The class for an author extended with variables from the gutenberg project.
Child of the generic Author class.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor--example">Example</h6>
<pre><code>from pprint import pprint
from  dhtk.data_sources.gutenberg.author import GutenbergAuthor

# Create an author manually.
adam_smith_author = GutenbergAuthor(
    gutenberg_id='http://www.gutenberg.org/2009/agents/1158',
    name='Smith, Adam'
)

# create an author form the gutenberg repository

from dhtk.data_sources.gutenberg.data import GutenbergData

database = GutenbergData()
database.search_author_by_name("Adam", "Smith")
# [('Smith, Adam', 'http://www.gutenberg.org/2009/agents/1158'),
#  ('Smith, George Adam', 'http://www.gutenberg.org/2009/agents/5016')]

adam_smith_author_pg = database.author_from_author_id(
    'http://www.gutenberg.org/2009/agents/1158'
)

adam_smith_author_pg.print_info()
# Adam Smith
# Metadata    :
#     - gutenberg_id: http://www.gutenberg.org/2009/agents/1158
#     - id          : http://www.gutenberg.org/2009/agents/1158
#     - gutenberg_name:  Smith, Adam
#     - gutenberg_aliases:
#     - aliases     :
#     - web_pages   :
#             - http://en.wikipedia.org/wiki/Adam_Smith
#     - birth_date  :         1723
#     - death_date  :         1790
</code></pre>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GutenbergAuthor</span><span class="p">(</span><span class="n">Author</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The class for an author extended with variables from the gutenberg project.</span>
<span class="sd">    Child of the generic Author class.</span>

<span class="sd">    Example</span>
<span class="sd">    --------</span>

<span class="sd">        from pprint import pprint</span>
<span class="sd">        from  dhtk.data_sources.gutenberg.author import GutenbergAuthor</span>

<span class="sd">        # Create an author manually.</span>
<span class="sd">        adam_smith_author = GutenbergAuthor(</span>
<span class="sd">            gutenberg_id=&#39;http://www.gutenberg.org/2009/agents/1158&#39;,</span>
<span class="sd">            name=&#39;Smith, Adam&#39;</span>
<span class="sd">        )</span>

<span class="sd">        # create an author form the gutenberg repository</span>

<span class="sd">        from dhtk.data_sources.gutenberg.data import GutenbergData</span>

<span class="sd">        database = GutenbergData()</span>
<span class="sd">        database.search_author_by_name(&quot;Adam&quot;, &quot;Smith&quot;)</span>
<span class="sd">        # [(&#39;Smith, Adam&#39;, &#39;http://www.gutenberg.org/2009/agents/1158&#39;),</span>
<span class="sd">        #  (&#39;Smith, George Adam&#39;, &#39;http://www.gutenberg.org/2009/agents/5016&#39;)]</span>

<span class="sd">        adam_smith_author_pg = database.author_from_author_id(</span>
<span class="sd">            &#39;http://www.gutenberg.org/2009/agents/1158&#39;</span>
<span class="sd">        )</span>

<span class="sd">        adam_smith_author_pg.print_info()</span>
<span class="sd">        # Adam Smith</span>
<span class="sd">        # Metadata    :</span>
<span class="sd">        #     - gutenberg_id: http://www.gutenberg.org/2009/agents/1158</span>
<span class="sd">        #     - id          : http://www.gutenberg.org/2009/agents/1158</span>
<span class="sd">        #     - gutenberg_name:  Smith, Adam</span>
<span class="sd">        #     - gutenberg_aliases:</span>
<span class="sd">        #     - aliases     :</span>
<span class="sd">        #     - web_pages   :</span>
<span class="sd">        #             - http://en.wikipedia.org/wiki/Adam_Smith</span>
<span class="sd">        #     - birth_date  :         1723</span>
<span class="sd">        #     - death_date  :         1790</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">web_pages</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Init function of GutenbergAuthor.</span>

<span class="sd">        Notes:</span>
<span class="sd">            Implement the Abstract Author class and extend it with the gutenberg id, the eventual alias(es) and the eventual web page(s) of the author. Converts name into a HumanName object with convert_name.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            gutenberg_id (str) : URI of the gutenberg author in the Gutenberg RDF.</span>
<span class="sd">            name (str) : Name of the author.</span>
<span class="sd">            aliases set(str):   Eventual aliases of the author.default None</span>
<span class="sd">            web_pages set(str):  Eventual web pages of the author. default None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">same_as</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">same_as</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">id_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;http://www.gutenberg.org/2009/agents/\d+$&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">id_format</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">gutenberg_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ReferenceError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This gutenberg id is not valid: </span><span class="si">{</span><span class="n">gutenberg_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gutenberg_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gutenberg_id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">aliases</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aliases</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">web_pages</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">web_pages</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;web_pages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_pages</span>

        <span class="c1"># Add saint to nameparser&#39;s FIRST_NAME_TITLES</span>
        <span class="n">FIRST_NAME_TITLES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;saint&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># LOGGER.debug(&quot;converting aliases names: %s&quot;, &quot;, &quot;.join(aliases))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_name</span><span class="p">(</span><span class="n">alias</span><span class="p">))</span> <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">aliases</span><span class="p">}</span>
        <span class="c1"># LOGGER.debug(&quot;aliases: %s&quot;, &quot;, &quot;.join(self.metadata[&quot;aliases&quot;]))</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]:</span>
            <span class="c1"># LOGGER.debug(&quot;removing &#39;%s&#39; from %s&quot;, str(name), &quot;, &quot;.join(self.metadata[&quot;aliases&quot;]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">same_as</span><span class="o">=</span><span class="n">same_as</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert human_name string containing into a HumanName object.</span>

<span class="sd">       Args:</span>
<span class="sd">          human_name(str): Author&#39;s name in a string.</span>

<span class="sd">        Returns:</span>


<span class="sd">        Notes:</span>
<span class="sd">            Is done in the init for every GutenbergAuthor object with initial string parameter &quot;name&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">human_name</span> <span class="o">=</span> <span class="n">HumanName</span><span class="p">(</span><span class="n">human_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_name_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">:</span>
            <span class="c1"># LOGGER.debug(&quot;%s nickname: %s&quot;, str(human_name), human_name.nickname)</span>
            <span class="n">no_nickname</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">human_name</span><span class="p">)</span>
            <span class="n">no_nickname</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">first_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([A-Z])[a-z]*[.])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\2</span><span class="se">\\</span><span class="s2">w+&quot;</span><span class="p">,</span> <span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">),</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">,</span>
                <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span>
            <span class="p">)</span>
            <span class="c1"># LOGGER.debug(</span>
            <span class="c1">#     &quot;%s, %s&quot;,</span>
            <span class="c1">#     re.sub(</span>
            <span class="c1">#         r&quot;(([A-Z])[a-z]*[.])&quot;, r&quot;\2\\w+&quot;,</span>
            <span class="c1">#         human_name.first,</span>
            <span class="c1">#         re.UNICODE</span>
            <span class="c1">#     ),</span>
            <span class="c1">#     human_name.nickname</span>
            <span class="c1"># )</span>
            <span class="k">if</span> <span class="n">first_name_match</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># LOGGER.debug(&quot;Adding %s to aliases&quot;, str(no_nickname))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">no_nickname</span><span class="p">),</span> <span class="p">}</span>
            <span class="n">middle_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([A-Z])[a-z]*[.])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\2</span><span class="se">\\</span><span class="s2">w+&quot;</span><span class="p">,</span> <span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">),</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">,</span>
                <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span>
            <span class="p">)</span>
            <span class="c1"># LOGGER.debug(</span>
            <span class="c1">#     &quot;%s, %s&quot;,</span>
            <span class="c1">#     re.sub(</span>
            <span class="c1">#         r&quot;(([A-Z])[a-z]*[.])&quot;, r&quot;\2\\w+&quot;,</span>
            <span class="c1">#         human_name.middle, re.UNICODE</span>
            <span class="c1">#     ),</span>
            <span class="c1">#     human_name.nickname</span>
            <span class="c1"># )</span>
            <span class="k">if</span> <span class="n">middle_name_match</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">middle_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">):</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">middle</span> <span class="o">=</span> <span class="n">middle_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># LOGGER.debug(&quot;Adding %s to aliases&quot;, str(no_nickname))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">no_nickname</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">human_name</span>

    <span class="k">def</span> <span class="nf">get_gutenberg_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the gutenberg id url of the author.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the guteneberg id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equality function between authors.</span>

<span class="sd">        Notes:</span>
<span class="sd">            Test the equality of the two authors. Using the gutenberg_id if other is an instance of</span>
<span class="sd">            GutenbergAuthor. If not, it uses the dhtk.common.author.Author.__eq__() method that uses the</span>
<span class="sd">            author&#39;s names (first, last) and its birthdate.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (dhtk.common.author.Author): An instance of dhtk.common.author.Author or cof its child-classes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            equality (bool) : A bool that tells if the authors are the same or not.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GutenbergAuthor</span><span class="p">):</span>
            <span class="n">equals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">equals</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">equals</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return hash for the author.</span>

<span class="sd">        Returns:</span>
<span class="sd">            hash (int) : The hash value for the author.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_birth_date</span><span class="p">()))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            object_str (str) : String representing the object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Author: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_last_name</span><span class="p">()</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> \
               <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&gt;)&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Equality function between authors.</p>
<p>!!! notes
    Test the equality of the two authors. Using the gutenberg_id if other is an instance of
    GutenbergAuthor. If not, it uses the dhtk.common.author.Author.<strong>eq</strong>() method that uses the
    author's names (first, last) and its birthdate.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>other</code></td>
        <td><code>dhtk.common.author.Author</code></td>
        <td><p>An instance of dhtk.common.author.Author or cof its child-classes.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>equality (bool) </code></td>
      <td><p>A bool that tells if the authors are the same or not.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equality function between authors.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Test the equality of the two authors. Using the gutenberg_id if other is an instance of</span>
<span class="sd">        GutenbergAuthor. If not, it uses the dhtk.common.author.Author.__eq__() method that uses the</span>
<span class="sd">        author&#39;s names (first, last) and its birthdate.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (dhtk.common.author.Author): An instance of dhtk.common.author.Author or cof its child-classes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        equality (bool) : A bool that tells if the authors are the same or not.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GutenbergAuthor</span><span class="p">):</span>
        <span class="n">equals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">equals</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">equals</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Return hash for the author.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>hash (int) </code></td>
      <td><p>The hash value for the author.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return hash for the author.</span>

<span class="sd">    Returns:</span>
<span class="sd">        hash (int) : The hash value for the author.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_birth_date</span><span class="p">()))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">web_pages</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Init function of GutenbergAuthor.</p>
<p>!!! notes
    Implement the Abstract Author class and extend it with the gutenberg id, the eventual alias(es) and the eventual web page(s) of the author. Converts name into a HumanName object with convert_name.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>gutenberg_id</code></td>
        <td><code>str) </code></td>
        <td><p>URI of the gutenberg author in the Gutenberg RDF.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str) </code></td>
        <td><p>Name of the author.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>aliases</code></td>
        <td><code>set(str</code></td>
        <td><p>Eventual aliases of the author.default None</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>web_pages</code></td>
        <td><code>set(str</code></td>
        <td><p>Eventual web pages of the author. default None</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">aliases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">web_pages</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Init function of GutenbergAuthor.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Implement the Abstract Author class and extend it with the gutenberg id, the eventual alias(es) and the eventual web page(s) of the author. Converts name into a HumanName object with convert_name.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        gutenberg_id (str) : URI of the gutenberg author in the Gutenberg RDF.</span>
<span class="sd">        name (str) : Name of the author.</span>
<span class="sd">        aliases set(str):   Eventual aliases of the author.default None</span>
<span class="sd">        web_pages set(str):  Eventual web pages of the author. default None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">same_as</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">same_as</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">id_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;http://www.gutenberg.org/2009/agents/\d+$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">id_format</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">gutenberg_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ReferenceError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This gutenberg id is not valid: </span><span class="si">{</span><span class="n">gutenberg_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gutenberg_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gutenberg_id</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
        <span class="n">aliases</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aliases</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">web_pages</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
        <span class="n">web_pages</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;web_pages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_pages</span>

    <span class="c1"># Add saint to nameparser&#39;s FIRST_NAME_TITLES</span>
    <span class="n">FIRST_NAME_TITLES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;saint&quot;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># LOGGER.debug(&quot;converting aliases names: %s&quot;, &quot;, &quot;.join(aliases))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_name</span><span class="p">(</span><span class="n">alias</span><span class="p">))</span> <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">aliases</span><span class="p">}</span>
    <span class="c1"># LOGGER.debug(&quot;aliases: %s&quot;, &quot;, &quot;.join(self.metadata[&quot;aliases&quot;]))</span>

    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]:</span>
        <span class="c1"># LOGGER.debug(&quot;removing &#39;%s&#39; from %s&quot;, str(name), &quot;, &quot;.join(self.metadata[&quot;aliases&quot;]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">same_as</span><span class="o">=</span><span class="n">same_as</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">


<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>object_str (str) </code></td>
      <td><p>String representing the object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        object_str (str) : String representing the object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Author: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_last_name</span><span class="p">()</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> \
           <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_gutenberg_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&gt;)&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.convert_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_name</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Convert human_name string containing into a HumanName object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>human_name(str)</code></td>
        <td></td>
        <td><p>Author's name in a string.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <p>Returns:</p>
<p>!!! notes
     Is done in the init for every GutenbergAuthor object with initial string parameter "name".</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert human_name string containing into a HumanName object.</span>

<span class="sd">   Args:</span>
<span class="sd">      human_name(str): Author&#39;s name in a string.</span>

<span class="sd">    Returns:</span>


<span class="sd">    Notes:</span>
<span class="sd">        Is done in the init for every GutenbergAuthor object with initial string parameter &quot;name&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">human_name</span> <span class="o">=</span> <span class="n">HumanName</span><span class="p">(</span><span class="n">human_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_name_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span>
        <span class="n">human_name</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">:</span>
        <span class="c1"># LOGGER.debug(&quot;%s nickname: %s&quot;, str(human_name), human_name.nickname)</span>
        <span class="n">no_nickname</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">human_name</span><span class="p">)</span>
        <span class="n">no_nickname</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">first_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([A-Z])[a-z]*[.])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\2</span><span class="se">\\</span><span class="s2">w+&quot;</span><span class="p">,</span> <span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">),</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">,</span>
            <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span>
        <span class="p">)</span>
        <span class="c1"># LOGGER.debug(</span>
        <span class="c1">#     &quot;%s, %s&quot;,</span>
        <span class="c1">#     re.sub(</span>
        <span class="c1">#         r&quot;(([A-Z])[a-z]*[.])&quot;, r&quot;\2\\w+&quot;,</span>
        <span class="c1">#         human_name.first,</span>
        <span class="c1">#         re.UNICODE</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     human_name.nickname</span>
        <span class="c1"># )</span>
        <span class="k">if</span> <span class="n">first_name_match</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">first</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1"># LOGGER.debug(&quot;Adding %s to aliases&quot;, str(no_nickname))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">no_nickname</span><span class="p">),</span> <span class="p">}</span>
        <span class="n">middle_name_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(([A-Z])[a-z]*[.])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\2</span><span class="se">\\</span><span class="s2">w+&quot;</span><span class="p">,</span> <span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">),</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">,</span>
            <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span>
        <span class="p">)</span>
        <span class="c1"># LOGGER.debug(</span>
        <span class="c1">#     &quot;%s, %s&quot;,</span>
        <span class="c1">#     re.sub(</span>
        <span class="c1">#         r&quot;(([A-Z])[a-z]*[.])&quot;, r&quot;\2\\w+&quot;,</span>
        <span class="c1">#         human_name.middle, re.UNICODE</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     human_name.nickname</span>
        <span class="c1"># )</span>
        <span class="k">if</span> <span class="n">middle_name_match</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">middle_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">):</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">middle</span> <span class="o">=</span> <span class="n">middle_name_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">human_name</span><span class="o">.</span><span class="n">nickname</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">human_name</span><span class="o">.</span><span class="n">middle</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1"># LOGGER.debug(&quot;Adding %s to aliases&quot;, str(no_nickname))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">no_nickname</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">human_name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.author.GutenbergAuthor.get_gutenberg_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_gutenberg_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Get the gutenberg id url of the author.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>the guteneberg id</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/author.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_gutenberg_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the gutenberg id url of the author.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the guteneberg id</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.tools.book" class="doc doc-heading">
        <code>book</code>



</h4>

    <div class="doc doc-contents ">

      <h6 id="dhtk.data_sources.gutenberg.tools.book--contains-the-gutenbergbook-class">Contains the GutenbergBook Class.</h6>
<p>Returns a Book object which is extended to contain parameters for gutenberg id</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook" class="doc doc-heading">
        <code>
GutenbergBook            (<span title="dhtk.data_sources.templates.book.Book">Book</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Extends the Book class for Project Gutenberg books.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span>  <span class="nn">dhtk.data_sources.gutenberg.tools.book</span> <span class="kn">import</span> <span class="n">GutenbergBook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span>  <span class="nn">dhtk.data_sources.gutenberg.tools.author</span> <span class="kn">import</span> <span class="n">GutenbergAuthor</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">moby_dick</span> <span class="o">=</span> <span class="n">GutenbergBook</span><span class="p">(</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Moby Dick&quot;</span><span class="p">,</span>
<span class="o">&gt;&gt;&gt;</span>    <span class="n">gutenberg_id</span><span class="o">=</span><span class="s2">&quot;http://www.gutenberg.org/ebooks/2489&quot;</span><span class="p">,</span>
<span class="o">&gt;&gt;&gt;</span>    <span class="n">author</span><span class="o">=</span><span class="n">GutenbergAuthor</span><span class="p">(</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="n">gutenberg_id</span><span class="o">=</span><span class="s1">&#39;http://www.gutenberg.org/2009/agents/9&#39;</span><span class="p">,</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Melville, Herman&#39;</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dhtk.data_sources.gutenberg.api.data</span> <span class="kn">import</span> <span class="n">GutenbergData</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">gutenberg_search</span> <span class="o">=</span> <span class="n">GutenbergData</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">book</span> <span class="o">=</span> <span class="n">gutenberg_search</span><span class="o">.</span><span class="n">book_from_book_id</span><span class="p">(</span><span class="s2">&quot;http://www.gutenberg.org/ebooks/2701&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">book</span><span class="o">.</span><span class="n">print_info</span><span class="p">()</span>
<span class="c1"># Title       : Moby Dick; Or, The Whale</span>
<span class="c1"># Author      : Herman Melville</span>
<span class="c1"># Metadata    :</span>
<span class="c1">#     - gutenberg_id: http://www.gutenberg.org/ebooks/2701</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GutenbergBook</span><span class="p">(</span><span class="n">Book</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extends the Book class for Project Gutenberg books.</span>


<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from pprint import pprint</span>
<span class="sd">        &gt;&gt;&gt; from  dhtk.data_sources.gutenberg.tools.book import GutenbergBook</span>
<span class="sd">        &gt;&gt;&gt; from  dhtk.data_sources.gutenberg.tools.author import GutenbergAuthor</span>

<span class="sd">        &gt;&gt;&gt; moby_dick = GutenbergBook(</span>
<span class="sd">        &gt;&gt;&gt;     title=&quot;Moby Dick&quot;,</span>
<span class="sd">        &gt;&gt;&gt;    gutenberg_id=&quot;http://www.gutenberg.org/ebooks/2489&quot;,</span>
<span class="sd">        &gt;&gt;&gt;    author=GutenbergAuthor(</span>
<span class="sd">        &gt;&gt;&gt;         gutenberg_id=&#39;http://www.gutenberg.org/2009/agents/9&#39;,</span>
<span class="sd">        &gt;&gt;&gt;         name=&#39;Melville, Herman&#39;</span>
<span class="sd">        &gt;&gt;&gt;     )</span>
<span class="sd">        &gt;&gt;&gt; )</span>

<span class="sd">        &gt;&gt;&gt; from dhtk.data_sources.gutenberg.api.data import GutenbergData</span>

<span class="sd">        &gt;&gt;&gt; gutenberg_search = GutenbergData()</span>
<span class="sd">        &gt;&gt;&gt; book = gutenberg_search.book_from_book_id(&quot;http://www.gutenberg.org/ebooks/2701&quot;)</span>
<span class="sd">        &gt;&gt;&gt; book.print_info()</span>
<span class="sd">        # Title       : Moby Dick; Or, The Whale</span>
<span class="sd">        # Author      : Herman Melville</span>
<span class="sd">        # Metadata    :</span>
<span class="sd">        #     - gutenberg_id: http://www.gutenberg.org/ebooks/2701</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Init function of the GutenbergBook Class.</span>

<span class="sd">        Args:</span>
<span class="sd">        gutenberg_id (str) :  Must start with &quot;http://www.gutenberg.org/ebooks/&quot;.</span>

<span class="sd">        author (dhtk.common.author.Author) :The object containing the author of the book. Of type dhtk.common.author.Author or a subclass of it.</span>

<span class="sd">        title (str) :The title of the book, in format given by Gutenberg.</span>

<span class="sd">        same_as (dict): A dictionary containing same_as URIs.</span>

<span class="sd">        **kwargs (dict) : Will be used as metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">same_as</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">same_as</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">id_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;http://www.gutenberg.org/ebooks/\d+$&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">id_format</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">gutenberg_id</span><span class="p">):</span>
            <span class="c1"># LOGGER.error(&quot;This gutenberg id is not valid! %s&quot;, gutenberg_id)</span>
            <span class="k">raise</span> <span class="ne">ReferenceError</span><span class="p">(</span><span class="s2">&quot;This gutenberg id is not valid! </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">gutenberg_id</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="o">=</span><span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="n">same_as</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_book_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_book_id_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_text_file_dir_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the suffix of the uri of the book in a gutenberg text repository.</span>

<span class="sd">        Args:</span>

<span class="sd">        Returns:</span>
<span class="sd">          str: Returns the suffix of the gutenberg file repository where the file is to be found:</span>

<span class="sd">        Args:</span>

<span class="sd">        Returns:</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        This method is generally used with::</span>

<span class="sd">            &quot;file://gutenberg/repository/path/&quot; + self.get_text_file_dir_path() + &quot;-file.extension&quot;</span>
<span class="sd">            #or</span>
<span class="sd">            &quot;http://distant.gutenberg-repository.path&quot; + self.get_text_file_dir_path() + &quot;-file.extension&quot;</span>

<span class="sd">        the &quot;-file.extension&quot; can be -0.txt, .zip, .txt depending on the presence in the repository</span>
<span class="sd">        and on the file encoding.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>

<span class="sd">            print(book.get_text_file_dir_path())</span>
<span class="sd">            # &quot;2/7/0/2701/2701&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># LOGGER.debug(&quot;id: %s&quot;, self.metadata.get(&quot;gutenberg_id&quot;, &quot;&quot;))</span>
        <span class="n">gutenberg_id_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;0/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gutenberg_id_num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">gutenberg_id_num</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gutenberg_id_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">all_but_last_digit</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gutenberg_id_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">subdir_part</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_but_last_digit</span><span class="p">)</span>
            <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subdir_part</span><span class="p">,</span> <span class="n">gutenberg_id_num</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">subdir</span>

    <span class="k">def</span> <span class="nf">repository</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">GutenbergTexts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">repo</span>

    <span class="k">def</span> <span class="nf">original_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="p">()</span><span class="o">.</span><span class="n">get_original_text</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">text</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equality function.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Test the equality of the two books. Using the gutenberg_id if other is an instance of</span>
<span class="sd">        GutenbergBook. If not, it uses the dhtk.common.author.Book.__eq__() method that uses the</span>
<span class="sd">        book&#39;s authors and titles.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            other: an instance from dhtk.data_sources.templates.Book or any child class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            equality: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GutenbergBook</span><span class="p">):</span>
            <span class="n">equals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_book_id</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">equals</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">equals</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns hash of attributes of gutenberg book.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The hash is created from:</span>
<span class="sd">            - author</span>
<span class="sd">            - title</span>
<span class="sd">            - first date (from metadata)</span>
<span class="sd">        Allows dictionary keys to be compared quickly.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            hash: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_edition_date</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object_str : String representing the object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;&lt;GutenbergBook: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2"> gutenberg_id: </span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Equality function.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--notes">Notes</h6>
<p>Test the equality of the two books. Using the gutenberg_id if other is an instance of
GutenbergBook. If not, it uses the dhtk.common.author.Book.<strong>eq</strong>() method that uses the
book's authors and titles.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--parameters">Parameters</h6>
<pre><code>other: an instance from dhtk.data_sources.templates.Book or any child class.
</code></pre>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__eq__--returns">Returns</h6>
<pre><code>equality: bool
</code></pre>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equality function.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Test the equality of the two books. Using the gutenberg_id if other is an instance of</span>
<span class="sd">    GutenbergBook. If not, it uses the dhtk.common.author.Book.__eq__() method that uses the</span>
<span class="sd">    book&#39;s authors and titles.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        other: an instance from dhtk.data_sources.templates.Book or any child class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        equality: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GutenbergBook</span><span class="p">):</span>
        <span class="n">equals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">get_book_id</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">equals</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">equals</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns hash of attributes of gutenberg book.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--notes">Notes</h6>
<p>The hash is created from:
    - author
    - title
    - first date (from metadata)
Allows dictionary keys to be compared quickly.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__hash__--returns">Returns</h6>
<pre><code>hash: int
</code></pre>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns hash of attributes of gutenberg book.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The hash is created from:</span>
<span class="sd">        - author</span>
<span class="sd">        - title</span>
<span class="sd">        - first date (from metadata)</span>
<span class="sd">    Allows dictionary keys to be compared quickly.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        hash: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_author</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_edition_date</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Init function of the GutenbergBook Class.</p>
      <p>gutenberg_id (str) :  Must start with "http://www.gutenberg.org/ebooks/".</p>
<p>author (dhtk.common.author.Author) :The object containing the author of the book. Of type dhtk.common.author.Author or a subclass of it.</p>
<p>title (str) :The title of the book, in format given by Gutenberg.</p>
<p>same_as (dict): A dictionary containing same_as URIs.</p>
<p>**kwargs (dict) : Will be used as metadata.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Init function of the GutenbergBook Class.</span>

<span class="sd">    Args:</span>
<span class="sd">    gutenberg_id (str) :  Must start with &quot;http://www.gutenberg.org/ebooks/&quot;.</span>

<span class="sd">    author (dhtk.common.author.Author) :The object containing the author of the book. Of type dhtk.common.author.Author or a subclass of it.</span>

<span class="sd">    title (str) :The title of the book, in format given by Gutenberg.</span>

<span class="sd">    same_as (dict): A dictionary containing same_as URIs.</span>

<span class="sd">    **kwargs (dict) : Will be used as metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">same_as</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">same_as</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">id_format</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;http://www.gutenberg.org/ebooks/\d+$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">id_format</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">gutenberg_id</span><span class="p">):</span>
        <span class="c1"># LOGGER.error(&quot;This gutenberg id is not valid! %s&quot;, gutenberg_id)</span>
        <span class="k">raise</span> <span class="ne">ReferenceError</span><span class="p">(</span><span class="s2">&quot;This gutenberg id is not valid! </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">gutenberg_id</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span> <span class="n">gutenberg_id</span><span class="o">=</span><span class="n">gutenberg_id</span><span class="p">,</span> <span class="n">same_as</span><span class="o">=</span><span class="n">same_as</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.__repr__--returns">Returns</h6>
<p>object_str : String representing the object</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object_str : String representing the object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="s2">&quot;&lt;GutenbergBook: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2"> gutenberg_id: </span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_author</span><span class="p">()</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_book_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_book_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_book_id_number" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_book_id_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_book_id_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_text_file_dir_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Return the suffix of the uri of the book in a gutenberg text repository.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Returns the suffix of the gutenberg file repository where the file is to be found:</p></td>
    </tr>
  </tbody>
</table>      <h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--notes">Notes</h6>
<p>This method is generally used with::</p>
<pre><code>"file://gutenberg/repository/path/" + self.get_text_file_dir_path() + "-file.extension"
#or
"http://distant.gutenberg-repository.path" + self.get_text_file_dir_path() + "-file.extension"
</code></pre>
<p>the "-file.extension" can be -0.txt, .zip, .txt depending on the presence in the repository
and on the file encoding.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_text_file_dir_path--example">Example</h6>
<pre><code>print(book.get_text_file_dir_path())
# "2/7/0/2701/2701"
</code></pre>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_text_file_dir_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the suffix of the uri of the book in a gutenberg text repository.</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>
<span class="sd">      str: Returns the suffix of the gutenberg file repository where the file is to be found:</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This method is generally used with::</span>

<span class="sd">        &quot;file://gutenberg/repository/path/&quot; + self.get_text_file_dir_path() + &quot;-file.extension&quot;</span>
<span class="sd">        #or</span>
<span class="sd">        &quot;http://distant.gutenberg-repository.path&quot; + self.get_text_file_dir_path() + &quot;-file.extension&quot;</span>

<span class="sd">    the &quot;-file.extension&quot; can be -0.txt, .zip, .txt depending on the presence in the repository</span>
<span class="sd">    and on the file encoding.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">        print(book.get_text_file_dir_path())</span>
<span class="sd">        # &quot;2/7/0/2701/2701&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># LOGGER.debug(&quot;id: %s&quot;, self.metadata.get(&quot;gutenberg_id&quot;, &quot;&quot;))</span>
    <span class="n">gutenberg_id_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;0/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gutenberg_id_num</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">gutenberg_id_num</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">gutenberg_id_num</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gutenberg_id_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">gutenberg_id_num</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">all_but_last_digit</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gutenberg_id_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">subdir_part</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_but_last_digit</span><span class="p">)</span>
        <span class="n">subdir</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subdir_part</span><span class="p">,</span> <span class="n">gutenberg_id_num</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">subdir</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.book.GutenbergBook.get_uri" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/book.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gutenberg_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>







  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="dhtk.data_sources.gutenberg.tools.texts" class="doc doc-heading">
        <code>texts</code>



</h4>

    <div class="doc doc-contents ">

      <p>Contains GutenbergTexts Class.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.texts--notes">Notes</h6>
<p>This class is being reworked.
The cleaning of the texts was adapted from: https://github.com/okfn/gutenizer</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts" class="doc doc-heading">
        <code>
GutenbergTexts        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Clean up Gutenberg texts by removing all the header and footer bumpf.</p>
      <h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts--notes">Notes</h6>
<p>Part of this class have to be reworked.</p>
<p>Usage : init and then run _extract_text.
_notes_end = ""
_header_end = ""
_footer_start = ""
_original_text = ""
_clean_text = ""
_url = ""</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GutenbergTexts</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clean up Gutenberg texts by removing all the header and footer bumpf.</span>

<span class="sd">    Args:</span>

<span class="sd">    Returns:</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Part of this class have to be reworked.</span>

<span class="sd">    Usage : init and then run _extract_text.</span>
<span class="sd">    _notes_end = &quot;&quot;</span>
<span class="sd">    _header_end = &quot;&quot;</span>
<span class="sd">    _footer_start = &quot;&quot;</span>
<span class="sd">    _original_text = &quot;&quot;</span>
<span class="sd">    _clean_text = &quot;&quot;</span>
<span class="sd">    _url = &quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">,</span> <span class="n">repository_uri</span><span class="o">=</span><span class="s1">&#39;http://aleph.gutenberg.org&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Init function of the GutenbergTexts.</span>

<span class="sd">        Check repository_uri and create a temporary directory for file operations.</span>
<span class="sd">        repository_uri: can be local file:/path/to/dir</span>
<span class="sd">        refer to:</span>
<span class="sd">        https://www.gutenberg.org/wiki/Gutenberg:Information_About_Robot_Access_to_our_Pages</span>
<span class="sd">        to download the files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ------------------</span>
<span class="sd">        repository_uri : str</span>
<span class="sd">            Can be a file uri file://home/user/Documents/gutenberg_dump or</span>
<span class="sd">            a http uri: http://aleph.gutenberg.org</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">repository_uri</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please set the URI of a &#39;local&#39; gutenberg text repository.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;http://www.gutenberg.org/files&quot;</span> <span class="ow">in</span> <span class="n">repository_uri</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Please create a local repository. More information on:</span>
<span class="sd">                https://www.gutenberg.org/wiki/Gutenberg:Information_About_Robot_Access_to_our_Pages</span>
<span class="sd">                &quot;&quot;&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;dhtk-&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span> <span class="o">=</span> <span class="n">repository_uri</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">book</span> <span class="o">=</span> <span class="n">book</span>

    <span class="k">def</span> <span class="nf">get_original_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns original text of a given book.&quot;&quot;&quot;</span>

        <span class="n">found_url</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span>

        <span class="n">base_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_dir_path</span><span class="p">()</span>

        <span class="n">valid_extensions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;-0.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="p">):</span>
            <span class="n">valid_extensions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;-0.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-0.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;.zip&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">valid_extensions</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">extension</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">found_url</span> <span class="o">=</span> <span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># aleph is not reliable, just use gutenberg directly for now</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span><span class="p">,</span> <span class="s2">&quot;http://www.gutenberg.org/files&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_dir_path</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

                <span class="n">found_url</span> <span class="o">=</span> <span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">found_url</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># TODO: once search does not find audio editions anymore uncomment this:</span>
        <span class="c1"># if not found_url:</span>
        <span class="c1">#     raise Warning(</span>
        <span class="c1">#        &quot;Could not find the text file for {} {}.&quot;.format(</span>
        <span class="c1">#           book.get_author(),</span>
        <span class="c1">#           book.get_title()</span>
        <span class="c1">#       )</span>
        <span class="c1">#    )</span>
        <span class="c1"># TODO: once search does not find audio anymore editions remove this:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_url</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="n">download_files</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">_title</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">raw_file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="n">unarchive_book</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">book_text_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="n">book_text_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ex</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span>

    <span class="k">def</span> <span class="nf">save_original_text_file_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destination</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the original text to a text-file in or at destination.</span>

<span class="sd">        Args:</span>
<span class="sd">          destination(str): Path of the destination where the text will be saved.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">destination</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filename</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">get_original_text</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">destination</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_writer</span><span class="p">:</span>
                <span class="n">file_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="c1"># LOGGER.warning(&quot;File %s could not be created.&quot;, filename)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File </span><span class="si">%s</span><span class="s2"> could not be created.&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filename</span>

    <span class="c1"># def save_clean_text_file_to(self, destination):</span>
    <span class="c1">#     &quot;&quot;&quot;Save the clean text to a text-file in or at destination.</span>
    <span class="c1">#</span>
    <span class="c1">#     Args:</span>
    <span class="c1">#       destination(str): Path of the destination where the text will be saved.</span>
    <span class="c1">#</span>
    <span class="c1">#     Returns:</span>
    <span class="c1">#</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self.get_original_text()</span>
    <span class="c1">#</span>
    <span class="c1">#     destination = Path(destination)</span>
    <span class="c1">#</span>
    <span class="c1">#     if not destination.is_dir():</span>
    <span class="c1">#         destination.mkdir(parents=True, exist_ok=True)</span>
    <span class="c1">#</span>
    <span class="c1">#     filename = self.book.get_text_file_name()</span>
    <span class="c1">#</span>
    <span class="c1">#     filename = destination / filename</span>
    <span class="c1">#     if not filename.is_file() or filename.stat().st_size == 0:</span>
    <span class="c1">#         with open(filename, &quot;w&quot;) as file_writer:</span>
    <span class="c1">#             file_writer.write(self._clean_text)</span>
    <span class="c1">#</span>
    <span class="c1">#     return filename</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove temporary directory if instance is closed.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="k">pass</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">,</span> <span class="n">repository_uri</span><span class="o">=</span><span class="s1">&#39;http://aleph.gutenberg.org&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Init function of the GutenbergTexts.</p>
<p>Check repository_uri and create a temporary directory for file operations.
repository_uri: can be local file:/path/to/dir
refer to:
https://www.gutenberg.org/wiki/Gutenberg:Information_About_Robot_Access_to_our_Pages
to download the files.</p>
<h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.__init__--parameters">Parameters</h6>
<p>repository_uri : str
    Can be a file uri file://home/user/Documents/gutenberg_dump or
    a http uri: http://aleph.gutenberg.org</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book</span><span class="p">,</span> <span class="n">repository_uri</span><span class="o">=</span><span class="s1">&#39;http://aleph.gutenberg.org&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Init function of the GutenbergTexts.</span>

<span class="sd">    Check repository_uri and create a temporary directory for file operations.</span>
<span class="sd">    repository_uri: can be local file:/path/to/dir</span>
<span class="sd">    refer to:</span>
<span class="sd">    https://www.gutenberg.org/wiki/Gutenberg:Information_About_Robot_Access_to_our_Pages</span>
<span class="sd">    to download the files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------------</span>
<span class="sd">    repository_uri : str</span>
<span class="sd">        Can be a file uri file://home/user/Documents/gutenberg_dump or</span>
<span class="sd">        a http uri: http://aleph.gutenberg.org</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">repository_uri</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please set the URI of a &#39;local&#39; gutenberg text repository.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;http://www.gutenberg.org/files&quot;</span> <span class="ow">in</span> <span class="n">repository_uri</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Please create a local repository. More information on:</span>
<span class="sd">            https://www.gutenberg.org/wiki/Gutenberg:Information_About_Robot_Access_to_our_Pages</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;dhtk-&quot;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span> <span class="o">=</span> <span class="n">repository_uri</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">book</span> <span class="o">=</span> <span class="n">book</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Remove temporary directory if instance is closed.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove temporary directory if instance is closed.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.get_original_text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_original_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Returns original text of a given book.</p>

        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_original_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns original text of a given book.&quot;&quot;&quot;</span>

    <span class="n">found_url</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span>

    <span class="n">base_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_dir_path</span><span class="p">()</span>

    <span class="n">valid_extensions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;-0.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="p">):</span>
        <span class="n">valid_extensions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;-0.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;-0.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;-8.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;.zip&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">valid_extensions</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">extension</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">found_url</span> <span class="o">=</span> <span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># aleph is not reliable, just use gutenberg directly for now</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_repository_uri</span><span class="p">,</span> <span class="s2">&quot;http://www.gutenberg.org/files&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_book_id_number</span><span class="p">()</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_dir_path</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

            <span class="n">found_url</span> <span class="o">=</span> <span class="n">url_exists</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">found_url</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># TODO: once search does not find audio editions anymore uncomment this:</span>
    <span class="c1"># if not found_url:</span>
    <span class="c1">#     raise Warning(</span>
    <span class="c1">#        &quot;Could not find the text file for {} {}.&quot;.format(</span>
    <span class="c1">#           book.get_author(),</span>
    <span class="c1">#           book.get_title()</span>
    <span class="c1">#       )</span>
    <span class="c1">#    )</span>
    <span class="c1"># TODO: once search does not find audio anymore editions remove this:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_url</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">raw_file_path</span> <span class="o">=</span> <span class="n">download_files</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temporary_dir</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">_title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw_file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="n">unarchive_book</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">book_text_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span> <span class="o">=</span> <span class="n">book_text_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ex</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="dhtk.data_sources.gutenberg.tools.texts.GutenbergTexts.save_original_text_file_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_original_text_file_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Save the original text to a text-file in or at destination.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>destination(str)</code></td>
        <td></td>
        <td><p>Path of the destination where the text will be saved.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_original_text_file_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destination</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save the original text to a text-file in or at destination.</span>

<span class="sd">    Args:</span>
<span class="sd">      destination(str): Path of the destination where the text will be saved.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">book</span><span class="o">.</span><span class="n">get_text_file_name</span><span class="p">()</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">filename</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">get_original_text</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">destination</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_writer</span><span class="p">:</span>
            <span class="n">file_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_text</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="c1"># LOGGER.warning(&quot;File %s could not be created.&quot;, filename)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File </span><span class="si">%s</span><span class="s2"> could not be created.&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filename</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="dhtk.data_sources.gutenberg.tools.texts.unarchive_book" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unarchive_book</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path(str)</code></td>
        <td></td>
        <td><p>Path of the archive of a book. A Zip file containing a single txt file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>destination(str,</code></td>
        <td><code>optional</code></td>
        <td><p>Path where the texfile should be extracted. (Default value = None)</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dhtk/data_sources/gutenberg/tools/texts.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">unarchive_book</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">      path(str): Path of the archive of a book. A Zip file containing a single txt file.</span>
<span class="sd">      destination(str, optional): Path where the texfile should be extracted. (Default value = None)</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">archive</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">raw_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">txt_file</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">txt_file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.txt&quot;</span><span class="p">):</span>
            <span class="n">raw_text</span> <span class="o">=</span> <span class="n">archive</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">txt_file</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="n">detect</span> <span class="o">=</span> <span class="n">chardet</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">raw_text</span><span class="p">)</span>

    <span class="n">raw_text</span> <span class="o">=</span> <span class="n">raw_text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">detect</span><span class="p">[</span><span class="s2">&quot;encoding&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">destination</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="k">as</span> <span class="n">out_file</span><span class="p">:</span>
                <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="c1"># TODO: fix logger this</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> could not be written.&quot;</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">raw_text</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../faq/" class="md-footer__link md-footer__link--prev" aria-label="Previous: FAQ" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              FAQ
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.092fa1f6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
    
  </body>
</html>